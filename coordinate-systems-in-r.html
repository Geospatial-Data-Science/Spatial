<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Coordinate Systems in R | Intro to GIS and Spatial Analysis</title>
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Coordinate Systems in R | Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Coordinate Systems in R | Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="raster-operations-in-r.html"/>
<link rel="next" href="point-pattern-analysis-in-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39623718-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-39623718-2');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a><ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>I Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="chp02-0.html"><a href="chp02-0.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a><ul>
<li class="chapter" data-level="2.1" data-path="chp02-0.html"><a href="chp02-0.html#vector-vs.-raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a><ul>
<li class="chapter" data-level="2.1.1" data-path="chp02-0.html"><a href="chp02-0.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="chp02-0.html"><a href="chp02-0.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chp02-0.html"><a href="chp02-0.html#object-vs.-field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chp02-0.html"><a href="chp02-0.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="chp02-0.html"><a href="chp02-0.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chp02-0.html"><a href="chp02-0.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="chp02-0.html"><a href="chp02-0.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chp02-0.html"><a href="chp02-0.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="chp02-0.html"><a href="chp02-0.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a><ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a><ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a><ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a><ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a><ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a><ul>
<li class="chapter" data-level="4.5.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#an-interactive-example"><i class="fa fa-check"></i><b>4.5.1</b> An Interactive Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>5</b> Pitfalls to avoid</a><ul>
<li class="chapter" data-level="5.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>5.1</b> Representing Count</a></li>
<li class="chapter" data-level="5.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>5.2</b> MAUP</a></li>
<li class="chapter" data-level="5.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>5.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="5.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>5.4</b> Mapping rates</a></li>
<li class="chapter" data-level="5.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>5.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>6</b> Good Map Making Tips</a><ul>
<li class="chapter" data-level="6.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>6.1</b> Elements of a map</a></li>
<li class="chapter" data-level="6.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>6.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="6.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>6.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html"><i class="fa fa-check"></i><b>7</b> Uncertainty in Census Data</a><ul>
<li class="chapter" data-level="7.1" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#mapping-uncertainty"><i class="fa fa-check"></i><b>7.2</b> Mapping uncertainty</a></li>
<li class="chapter" data-level="7.3" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="7.4" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#class-comparison-maps"><i class="fa fa-check"></i><b>7.4</b> Class comparison maps</a></li>
<li class="chapter" data-level="7.5" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>7.5</b> Problem when performing bivariate analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a><ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a><ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a><ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp09-0.html"><a href="chp09-0.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1" data-path="chp09-0.html"><a href="chp09-0.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1.1" data-path="chp09-0.html"><a href="chp09-0.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="chp09-0.html"><a href="chp09-0.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="chp09-0.html"><a href="chp09-0.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="chp09-0.html"><a href="chp09-0.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chp09-0.html"><a href="chp09-0.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chp09-0.html"><a href="chp09-0.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp09-0.html"><a href="chp09-0.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp09-0.html"><a href="chp09-0.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp09-0.html"><a href="chp09-0.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
<li class="chapter" data-level="9.4" data-path="chp09-0.html"><a href="chp09-0.html#geodesic-geometries"><i class="fa fa-check"></i><b>9.4</b> Geodesic geometries</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp10-0.html"><a href="chp10-0.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a><ul>
<li class="chapter" data-level="10.1" data-path="chp10-0.html"><a href="chp10-0.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="chp10-0.html"><a href="chp10-0.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="chp10-0.html"><a href="chp10-0.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="chp10-0.html"><a href="chp10-0.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="chp10-0.html"><a href="chp10-0.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a><ul>
<li class="chapter" data-level="10.5.1" data-path="chp10-0.html"><a href="chp10-0.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp10-0.html"><a href="chp10-0.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="chp10-0.html"><a href="chp10-0.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="chp10-0.html"><a href="chp10-0.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="chp11-0.html"><a href="chp11-0.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="chp11-0.html"><a href="chp11-0.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="chp11-0.html"><a href="chp11-0.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a><ul>
<li class="chapter" data-level="11.2.1" data-path="chp11-0.html"><a href="chp11-0.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="chp11-0.html"><a href="chp11-0.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="chp11-0.html"><a href="chp11-0.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chp11-0.html"><a href="chp11-0.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a><ul>
<li class="chapter" data-level="11.3.1" data-path="chp11-0.html"><a href="chp11-0.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="chp11-0.html"><a href="chp11-0.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="chp11-0.html"><a href="chp11-0.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chp11-0.html"><a href="chp11-0.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a><ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#PPM"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s I</a><ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s I</a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s I at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a><ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html"><i class="fa fa-check"></i>Reading and writing spatial data in R</a><ul>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4"><i class="fa fa-check"></i>Creating spatial objects</a><ul>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_1"><i class="fa fa-check"></i>Reading a shapefile</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_2"><i class="fa fa-check"></i>Reading a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_3"><i class="fa fa-check"></i>Reading a raster</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_5"><i class="fa fa-check"></i>Creating a spatial object from a data frame</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_6"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
</ul></li>
<li><a href="app1-1.html#app1_5">Converting from an <code>sf</code> object</a><ul>
<li><a href="app1-1.html#app1_5_1">Converting an <code>sf</code> object to a <code>Spatial*</code> object (<code>spdep</code>/<code>sp</code>)</a></li>
<li><a href="app1-1.html#app1_5_2">Converting an <code>sf</code> polygon object to an <code>owin</code> object</a></li>
<li><a href="app1-1.html#app1_5_3">Converting an <code>sf</code> point object to a <code>ppp</code> object</a></li>
<li><a href="app1-1.html#app1_5_4">Converting a <code>raster</code> object to an <code>im</code> object (<code>spatstat</code>)</a></li>
</ul></li>
<li><a href="app1-1.html#app1_6">Converting to an <code>sf</code> object</a></li>
<li><a href="app1-1.html#app1_7">Dissecting the <code>sf</code> file object</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_8"><i class="fa fa-check"></i>Exporting to different data file formats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html"><i class="fa fa-check"></i>Mapping data in R</a><ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2"><i class="fa fa-check"></i>The basics</a><ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_1"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_2"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_3"><i class="fa fa-check"></i>Tweaking colors</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_4"><i class="fa fa-check"></i>Adding labels</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_5"><i class="fa fa-check"></i>Adding a grid or graticule</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_3"><i class="fa fa-check"></i>Adding statistical plots</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_4"><i class="fa fa-check"></i>Mapping raster files</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_5"><i class="fa fa-check"></i>Changing coordinate systems</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_6"><i class="fa fa-check"></i>Side-by-side maps</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_7"><i class="fa fa-check"></i>Splitting data by polygons or group of polygons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i>Mapping rates in R</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_1"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_2"><i class="fa fa-check"></i>Standardized mortality ratios (relative risk).</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_3"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_4"><i class="fa fa-check"></i>Unstable ratios</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_4_1"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_4_2"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i>Vector operations in R</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_1"><i class="fa fa-check"></i>Dissolve by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_2"><i class="fa fa-check"></i>Dissolve by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_3"><i class="fa fa-check"></i>Calculate area</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_4"><i class="fa fa-check"></i>Subsetting</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_5"><i class="fa fa-check"></i>Intersecting</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-polygons-with-line-and-point-objects"><i class="fa fa-check"></i>Intersecting polygons with line and point objects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_6"><i class="fa fa-check"></i>Unioning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i>Raster operations in R</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_2"><i class="fa fa-check"></i>Local operations and functions</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_2_1"><i class="fa fa-check"></i>Unary operations and functions (applied to single rasters)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_2_2"><i class="fa fa-check"></i>Binary operations and functions (where two rasters are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_5"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_6"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_7"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_8"><i class="fa fa-check"></i>Computing cumulative distances</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_8_1"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i>Coordinate Systems in R</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#sample-files-for-this-exercise"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-proj4-coordinate-syntax"><i class="fa fa-check"></i>Understanding the Proj4 coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#transforming-coordinate-systems"><i class="fa fa-check"></i>Transforming coordinate systems</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#example-of-a-failed-transformation"><i class="fa fa-check"></i>Example of a failed transformation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-containment"><i class="fa fa-check"></i>A note about containment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#creating-tissot-indicatrix-circles"><i class="fa fa-check"></i>Creating Tissot indicatrix circles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i>Point pattern analysis in R</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li><a href="point-pattern-analysis-in-r.html#pppR2">Getting external data into a <code>spatstat</code> format</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR3"><i class="fa fa-check"></i>Prepping the data</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR4"><i class="fa fa-check"></i>Density based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR5"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR6"><i class="fa fa-check"></i>Quadrat density on a tessellated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR7"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR8"><i class="fa fa-check"></i>Kernel density adjusted for covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR9"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR10"><i class="fa fa-check"></i>Distance based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR11"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR12"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR13"><i class="fa fa-check"></i>Pair correlation function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR14"><i class="fa fa-check"></i>Hypothesis tests</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR15"><i class="fa fa-check"></i>Test for clustering/dispersion</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR16"><i class="fa fa-check"></i>Computing a pseudo p-value from the simulation</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR17"><i class="fa fa-check"></i>Test for a poisson point process model with a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i>Spatial autocorrelation in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_3"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_4"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the hard way</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-a-pseudo-p-value-from-an-mc-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from an MC simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_5"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the easy way</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_6"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i>Interpolation in R</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li><a href="interpolation-in-r.html#st-order-polynomial-fit">1<sup>st</sup> order polynomial fit</a></li>
<li><a href="interpolation-in-r.html#nd-order-polynomial">2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps"><i class="fa fa-check"></i>Generate the variance and confidence interval maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="coordinate-systems-in-r" class="section level1 unnumbered">
<h1>Coordinate Systems in R</h1>
<table class="package_ver_table">
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
R
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
geosphere
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
maptools
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
tmap
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
raster
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sp
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sf
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
4.0.1
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.5.10
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.0.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.4.5
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.4.4
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
0.9.6
</td>
</tr>
</tbody>
</table>
<div id="sample-files-for-this-exercise" class="section level2 unnumbered">
<h2>Sample files for this exercise</h2>
<p>Data used in this exercise can be loaded into your current R session by running the following chunk of code.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="coordinate-systems-in-r.html#cb157-1"></a><span class="kw">load</span>(<span class="kw">url</span>(<span class="st">&quot;http://github.com/mgimond/Spatial/raw/master/Data/Sample1.RData&quot;</span>))</span></code></pre></div>
<p>Only two data layers will be used in this exercise: a Maine counties polygon layer (<code>s.sf</code>) and an elevation raster layer (<code>elev.r</code>). The former is in an <code>sf</code> format and the latter is in a <code>raster</code> format. You can remove the other data objects from your environment via:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="coordinate-systems-in-r.html#cb158-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;inter.sf&quot;</span>, <span class="st">&quot;p.sf&quot;</span>, <span class="st">&quot;rail.sf&quot;</span>))</span></code></pre></div>
</div>
<div id="checking-for-a-coordinate-system" class="section level2 unnumbered">
<h2>Checking for a coordinate system</h2>
<p>To extract coordinate system (CS) information from an <code>sf</code> object use <code>st_crs</code> from the <em>sf</em> package; for a <code>raster</code> object use the <code>crs</code> function from the <em>raster</em> package.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="coordinate-systems-in-r.html#cb159-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb159-2"><a href="coordinate-systems-in-r.html#cb159-2"></a><span class="kw">st_crs</span>(s.sf)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  User input: EPSG:26919 
  wkt:
PROJCRS[&quot;NAD83 / UTM zone 19N&quot;,
    BASEGEOGCRS[&quot;NAD83&quot;,
        DATUM[&quot;North American Datum 1983&quot;,
            ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4269]],
    CONVERSION[&quot;UTM zone 19N&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,-69,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,500000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,0,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;North America - 72Â°W to 66Â°W and NAD83 by country&quot;],
        BBOX[14.92,-72,84,-66]],
    ID[&quot;EPSG&quot;,26919]]</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="coordinate-systems-in-r.html#cb161-1"></a><span class="kw">library</span>(raster)</span>
<span id="cb161-2"><a href="coordinate-systems-in-r.html#cb161-2"></a><span class="kw">crs</span>(elev.r)</span></code></pre></div>
<pre><code>CRS arguments:
 +proj=utm +zone=19 +datum=NAD83 +units=m +no_defs +ellps=GRS80
+towgs84=0,0,0 </code></pre>
<p>There are two ways of defining a coordinate system: via the <strong>EPSG</strong> numeric <a href="http://spatialreference.org/ref/epsg/">code</a> or via the <strong>PROJ4</strong> <a href="https://proj4.org/apps/proj.html">formatted string</a>. The EPSG code may not always be available for a particular coordinate system, but if a spatial object has a defined coordinate system, it will always have a PROJ4 projection string. Its multi-parameter syntax is briefly discussed next.</p>
</div>
<div id="understanding-the-proj4-coordinate-syntax" class="section level2 unnumbered">
<h2>Understanding the Proj4 coordinate syntax</h2>
<p>The <a href="http://proj4.org/">PROJ4</a> syntax consists of a list of parameters, each prefixed with the <code>+</code> character. For example, <code>elev.r</code>’s CS is in a UTM projection (<code>+proj=utm</code>) for zone 19 (<code>+zone=19</code>) and in an NAD 1983 datum (<code>+datum=NAD83</code>). Other bits of information that can be gleaned from the projection string are the units (meters) and the underlying ellipsoid (GRS80).</p>
<p>A list of a few of the PROJ4 parameters used in defining a coordinate system follows. Click <a href="https://proj4.org/usage/projections.html">here</a> for a full list of parameters.</p>
<pre><code>+a         Semimajor radius of the ellipsoid axis
+b         Semiminor radius of the ellipsoid axis
+datum     Datum name 
+ellps     Ellipsoid name 
+lat_0     Latitude of origin
+lat_1     Latitude of first standard parallel
+lat_2     Latitude of second standard parallel
+lat_ts    Latitude of true scale
+lon_0     Central meridian
+over      Allow longitude output outside -180 to 180 range, disables wrapping 
+proj      Projection name 
+south     Denotes southern hemisphere UTM zone
+units     meters, US survey feet, etc.
+x_0       False easting
+y_0       False northing
+zone      UTM zone</code></pre>
<p>You can view the list of available projections <code>+proj=</code> <a href="https://proj4.org/operations/projections/">here</a>.</p>
</div>
<div id="assigning-a-coordinate-system" class="section level2 unnumbered">
<h2>Assigning a coordinate system</h2>
<p>A coordinate system definition can be passed to a spatial object. It can either fill a spatial object’s empty CS definition or it can overwrite and existing definition (the latter should only be executed if there is good reason to believe that the original definition is erroneous). Note that this step <strong>does not</strong> change an objects underlying coordinate system (this option will be discussed in the next section).</p>
<p>We’ll pretend that a CS definition was not assigned to <code>s.sf</code> and assign one manually using the <code>st_set_crs()</code> function.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="coordinate-systems-in-r.html#cb164-1"></a>s.sf &lt;-<span class="st"> </span><span class="kw">st_set_crs</span>(s.sf, <span class="st">&quot;+proj=utm +zone=19 +ellps=GRS80 +datum=NAD83&quot;</span>) </span></code></pre></div>
<p>To do the same with a raster object simply assign the PROJ4 string to the <code>crs()</code> function as follows (here too we’ll assume that the spatial object had a missing reference system or an incorrectly defined one).</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="coordinate-systems-in-r.html#cb165-1"></a><span class="kw">crs</span>(elev.r) &lt;-<span class="st"> &quot;+proj=utm +zone=19 +ellps=GRS80 +datum=NAD83&quot;</span></span></code></pre></div>
<p>Note that we do not need to define all of the parameters so long as we know that the default values for these unused parameters are correct. Also note that we do not need to designate a hemisphere since the NAD83 datum applies only to North America.</p>
<p>To recreate a CS defined in a software such as ArcGIS, it is best to extract the CS’ <strong>WKID/EPSG</strong> code then use that number to look up the PROJ4 syntax on <a href="http://spatialreference.org/ref/">http://spatialreference.org/ref/</a>. For example, in ArcGIS, the WKID number can be extracted from the coordinate system properties output.</p>
<div class="figure" style="text-align: center"><span id="fig:fA2-arcgis"></span>
<img src="img/ArcGIS_UTMNAD83.jpg" alt="An ArcGIS dataframe coordinate system properties window. Note the WKID/EPSG code of 26919 (highlighted in red) associated with the NAD 1983 UTM Zone 19 N CS." width="471" />
<p class="caption">
Figure 14.20: An ArcGIS dataframe coordinate system properties window. Note the WKID/EPSG code of 26919 (highlighted in red) associated with the NAD 1983 UTM Zone 19 N CS.
</p>
</div>
<p>That number can then be entered in the <a href="http://spatialreference.org/ref/">http://spatialreference.org/ref/</a>’s search box to pull the Proj4 parameters (note that you must select <strong>Proj4</strong> from the list of syntax options).</p>
<div class="figure" style="text-align: center"><span id="fig:fA2-epsg"></span>
<img src="img/EPSG_search.jpg" alt="Example of a search result for EPSG **26919** at [http://spatialreference.org/ref/](http://spatialreference.org/ref/). Note that after clicking the `EPSG:269191` link, you must then select the Proj4 syntax from a list of available syntaxes to view the projection parameters" width="420" />
<p class="caption">
Figure 14.21: Example of a search result for EPSG <strong>26919</strong> at <a href="http://spatialreference.org/ref/">http://spatialreference.org/ref/</a>. Note that after clicking the <code>EPSG:269191</code> link, you must then select the Proj4 syntax from a list of available syntaxes to view the projection parameters
</p>
</div>
<p>Here are examples of a few common projections:</p>
<table>
<thead>
<tr class="header">
<th align="left">Projection</th>
<th align="center">WKID</th>
<th align="center">Authority</th>
<th align="left">Syntax</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UTM NAD 83 Zone 19N</td>
<td align="center">26919</td>
<td align="center">EPSG</td>
<td align="left"><code>+proj=utm +zone=19 +ellps=GRS80 +datum=NAD83 +units=m +no_defs</code></td>
</tr>
<tr class="even">
<td align="left">USA Contiguous albers equal area</td>
<td align="center">102003</td>
<td align="center">ESRI</td>
<td align="left"><code>+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs</code></td>
</tr>
<tr class="odd">
<td align="left">Alaska albers equal area</td>
<td align="center">3338</td>
<td align="center">EPSG</td>
<td align="left"><code>+proj=aea +lat_1=55 +lat_2=65 +lat_0=50 +lon_0=-154 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs</code></td>
</tr>
<tr class="even">
<td align="left">World Robinson</td>
<td align="center">54030</td>
<td align="center">ESRI</td>
<td align="left"><code>+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs</code></td>
</tr>
</tbody>
</table>
</div>
<div id="transforming-coordinate-systems" class="section level2 unnumbered">
<h2>Transforming coordinate systems</h2>
<p>The last step showed you how to <em>define</em> or <em>modify</em> the coordinate system <em>definition</em>. This section shows you how to <strong>transform</strong> the coordinate values associated with the spatial object to a <em>different</em> coordinate system. For example, to transform the <code>s.sf</code> vector object to a geographic (lat/long) coordinate system, we’ll use <code>sf</code>’s <code>st_transform</code> function.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="coordinate-systems-in-r.html#cb166-1"></a>s.sf.gcs &lt;-<span class="st"> </span><span class="kw">st_transform</span>(s.sf, <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb166-2"><a href="coordinate-systems-in-r.html#cb166-2"></a><span class="kw">st_crs</span>(s.sf.gcs)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  User input: +proj=longlat +datum=WGS84 
  wkt:
GEOGCRS[&quot;unknown&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]],
        ID[&quot;EPSG&quot;,6326]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
        ID[&quot;EPSG&quot;,8901]],
    CS[ellipsoidal,2],
        AXIS[&quot;longitude&quot;,east,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]],
        AXIS[&quot;latitude&quot;,north,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                ID[&quot;EPSG&quot;,9122]]]]</code></pre>
<p>The raster object equivalent is:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="coordinate-systems-in-r.html#cb168-1"></a>elev.r.gcs &lt;-<span class="st"> </span><span class="kw">projectRaster</span>(elev.r, <span class="dt">crs=</span><span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb168-2"><a href="coordinate-systems-in-r.html#cb168-2"></a><span class="kw">crs</span>(elev.r.gcs)</span></code></pre></div>
<pre><code>CRS arguments: +proj=longlat +datum=WGS84 +no_defs </code></pre>
<p>A geographic coordinate system is often desired when overlapping a web based mapping service such as Google, Bing or OpenStreetMap. To check that <code>s.sf.gcs</code> was properly transformed, we’ll overlay it on top of an OpenStreetMap using the <code>leaflet</code> package.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="coordinate-systems-in-r.html#cb170-1"></a><span class="kw">library</span>(leaflet)</span>
<span id="cb170-2"><a href="coordinate-systems-in-r.html#cb170-2"></a><span class="kw">leaflet</span>(s.sf.gcs) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb170-3"><a href="coordinate-systems-in-r.html#cb170-3"></a><span class="st">  </span><span class="kw">addPolygons</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb170-4"><a href="coordinate-systems-in-r.html#cb170-4"></a><span class="st">  </span><span class="kw">addTiles</span>()</span></code></pre></div>
<div id="htmlwidget-39c0da9d891061ceb853" style="width:672px;height:288px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-39c0da9d891061ceb853">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addPolygons","args":[[[[{"lng":[-68.8202158959377,-68.8198428550497,-69.7172113864081,-70.0141447324675,-69.9849775559489,-69.2302960504507,-69.0469764226522,-69.0367145086766,-68.8948719922674,-68.5146730293485,-68.3912568471377,-68.3348137559721,-68.230806786,-67.7910107465827,-67.7802895897975,-67.7556150667948,-67.7945708237807,-67.7593671297629,-67.8030534244138,-67.8034327853946,-68.0442673817386,-68.257750377734,-68.2572772514418,-68.4078325338314,-68.4341625067183,-68.4319133825422,-68.4224909530257,-68.4387400670549,-68.4362514010004,-68.6938938179389,-68.694252612716,-68.8202158959377],"lat":[46.3975029038531,46.5705359589532,46.5717152261069,46.5705982792127,46.6913656690831,47.4533345006126,47.4220306664875,47.2573616325743,47.1822564988308,47.2969643184046,47.2850971526591,47.3573740966737,47.3521482087837,47.0610036015027,45.9470627402573,45.9165802073734,45.8784756943635,45.8277986000031,45.7945081327697,45.678113625476,45.6357807631594,45.6042463492548,45.594606809009,45.5720630897562,45.5845974397256,45.7599446848754,45.7710111673874,46.0930094834948,46.3810145069658,46.3848470216072,46.3967944836138,46.3975029038531]}]],[[{"lng":[-70.5522701227431,-70.3963831168109,-70.4162139103225,-70.2539641250507,-70.2474646866552,-70.3102952676871,-70.280022592967,-70.3048496270618,-70.2293253986393,-70.2834966236555,-70.1910584799657,-70.0466075265629,-70.0141447324675,-69.7172113864081,-69.7289361428492,-69.6834566513734,-69.6495652572825,-69.6752689193327,-69.7052760983507,-69.7206418498994,-69.7029409794692,-69.7193747748989,-69.7086322748495,-69.7304828042506,-69.7265610312492,-69.7650747961707,-69.7782284116275,-69.7939298015476,-69.7913890724336,-69.8119659995252,-69.7944713609759,-69.7784568156373,-69.7356779723452,-69.7394239742408,-69.6972404629698,-69.6985985058636,-69.7105691760799,-69.6957525991533,-69.7110878899268,-69.708417443498,-69.7775637658015,-69.6975434647965,-69.7067752036439,-69.649056075379,-69.6412510197776,-69.6070545516986,-69.4896050033377,-69.4937861591645,-69.3522667963532,-69.272746818761,-69.2827413720891,-69.2657354010438,-69.3240541092611,-69.34466947495,-69.3827629018954,-69.3955572045347,-69.4028421993842,-69.4624731039204,-69.4789760059387,-69.6255230025811,-69.6158402577664,-69.5767153087878,-69.5789425716592,-69.6025020127131,-69.7786921613885,-69.7984447826045,-69.8167637270293,-69.8233181813147,-69.8521814235339,-69.9216111657372,-69.9415176967544,-69.9738221777052,-69.958471449328,-69.9603562874987,-69.9966047653838,-70.0161687162882,-70.0031070530014,-70.0191980092982,-70.0296198941475,-70.0317562409298,-70.0239360067448,-70.0317259355667,-70.1295972351082,-70.136685478216,-70.1476796422889,-70.1516776708363,-70.1420187040757,-70.144551921604,-70.1074724551224,-70.1553480906383,-70.2900544452034,-70.3085022262742,-70.3631059114116,-70.3603211852718,-70.4176409561967,-70.5247769937588,-70.5104105421308,-70.5522701227431],"lat":[45.6606641600491,45.7220459893141,45.7903090009413,45.8990048581307,45.9446197653656,45.9687822572426,46.053154045756,46.0666583227557,46.1374344001399,46.1902492399916,46.3348397534767,46.4261155181296,46.5705982792127,46.5717152261069,45.9728200712922,45.9768793322142,45.8640350075469,45.8511147692878,45.8827532057036,45.8777445321509,45.8378016491936,45.826411184219,45.8105004023713,45.7754783851199,45.7552074644893,45.7555012451969,45.7746849026479,45.7536548974275,45.7421308816391,45.7368170304901,45.7243737520221,45.6886267890428,45.6740090360195,45.6562785854827,45.6531084372895,45.6421680458095,45.6384297109118,45.6155303569284,45.6100716616851,45.5806950932391,45.5380285611045,45.2948927775248,45.2924438969727,45.1026815562019,45.1033414360562,45.0131027364687,45.0306879284789,45.0550517308531,45.0730857012569,44.8066218852675,44.8019450165874,44.7232306436125,44.7170578296856,44.7538610252249,44.7519875321388,44.7437477888425,44.7028853841853,44.6957893704716,44.7182725826063,44.6998506517512,44.6607202633484,44.6302072178852,44.6060796937349,44.5794610687403,44.6047777546158,44.5761869498399,44.5808673929988,44.6098355902019,44.6207756708577,44.6087628839574,44.6408703541462,44.6591954632516,44.6687740819471,44.6802446359667,44.6758574554751,44.7581767161421,44.7614421837678,44.8158123362954,44.8138362712112,44.8321695135509,44.8337640936887,44.8655134425529,44.8555833334499,44.9005505865839,44.8999516282799,44.920169346162,44.9198908994501,44.9432595462267,44.9485849496765,45.126798305112,45.1123024469935,45.1649104851198,45.1604547160799,45.1521540512333,45.1450127607892,45.5126513681109,45.5136548123547,45.6606641600491]}]],[[{"lng":[-69.7172113864081,-68.8198428550497,-68.8202158959377,-68.8259919945306,-68.9522087549172,-68.9662604970057,-68.858461523151,-68.7750422555106,-68.8727778284688,-68.8532621071251,-69.3522667963532,-69.4937861591645,-69.4896050033377,-69.6070545516986,-69.6412510197776,-69.649056075379,-69.7067752036439,-69.6975434647965,-69.7775637658015,-69.708417443498,-69.7110878899268,-69.6957525991533,-69.7105691760799,-69.6985985058636,-69.6972404629698,-69.7394239742408,-69.7356779723452,-69.7784568156373,-69.7944713609759,-69.8119659995252,-69.7913890724336,-69.7939298015476,-69.7782284116275,-69.7650747961707,-69.7265610312492,-69.7304828042506,-69.7086322748495,-69.7193747748989,-69.7029409794692,-69.7206418498994,-69.7052760983507,-69.6752689193327,-69.6495652572825,-69.6834566513734,-69.7289361428492,-69.7172113864081],"lat":[46.5717152261069,46.5705359589532,46.3975029038531,45.6844204564528,45.663995574217,45.5125268830041,45.5258563731748,45.2439624650197,45.2294245420211,45.1458950871889,45.0730857012569,45.0550517308531,45.0306879284789,45.0131027364687,45.1033414360562,45.1026815562019,45.2924438969727,45.2948927775248,45.5380285611045,45.5806950932391,45.6100716616851,45.6155303569284,45.6384297109118,45.6421680458095,45.6531084372895,45.6562785854827,45.6740090360195,45.6886267890428,45.7243737520221,45.7368170304901,45.7421308816391,45.7536548974275,45.7746849026479,45.7555012451969,45.7552074644893,45.7754783851199,45.8105004023713,45.826411184219,45.8378016491936,45.8777445321509,45.8827532057036,45.8511147692878,45.8640350075469,45.9768793322142,45.9728200712922,46.5717152261069]}]],[[{"lng":[-69.3522667963532,-68.8532621071251,-68.8727778284688,-68.7750422555106,-68.858461523151,-68.9662604970057,-68.9522087549172,-68.8259919945306,-68.8202158959377,-68.694252612716,-68.6938938179389,-68.4362514010004,-68.4387400670549,-68.4224909530257,-68.4319133825422,-68.4341625067183,-68.4078325338314,-68.2572772514418,-68.257750377734,-68.0442673817386,-67.9374017094583,-68.0501369866226,-68.3005641369487,-68.2753564985761,-68.394538736644,-68.3763047508439,-68.4996991235541,-68.4451095291154,-68.6053095321548,-68.6494463147326,-68.6842837023874,-68.7181055754573,-68.7439616967955,-68.7663622296832,-68.7656147491982,-68.7962935157835,-68.8240041181253,-68.8318934588989,-68.8628237858996,-68.8919760946589,-68.8974313708356,-69.1800227685777,-69.20874292804,-69.2657354010438,-69.2827413720891,-69.272746818761,-69.3522667963532],"lat":[45.0730857012569,45.1458950871889,45.2294245420211,45.2439624650197,45.5258563731748,45.5125268830041,45.663995574217,45.6844204564528,46.3975029038531,46.3967944836138,46.3848470216072,46.3810145069658,46.0930094834948,45.7710111673874,45.7599446848754,45.5845974397256,45.5720630897562,45.594606809009,45.6042463492548,45.6357807631594,45.2683404617007,45.2559714702251,45.225625285573,45.1033141871315,45.0868371353288,44.9955238127473,44.9800582866187,44.7652354827514,44.7429960086223,44.7059329122171,44.7210274178153,44.6999819749911,44.6653601957484,44.6666990193435,44.6762623558473,44.6870575924088,44.6863059676007,44.7007748358147,44.7001375943256,44.6889223824163,44.6932405081234,44.6443454209155,44.7285108739399,44.7232306436125,44.8019450165874,44.8066218852675,45.0730857012569]}]],[[{"lng":[-67.1506607561156,-67.0653586188579,-67.1467066573937,-66.969271036002,-67.0077187507732,-67.2003646079872,-67.3084681377898,-67.3885104555116,-67.5709936034853,-67.6188382601856,-67.8112189325215,-67.8585605201949,-67.9000417759072,-67.9683422418549,-67.9634367619487,-67.986523698359,-68.0112605416211,-67.9949024836971,-68.0143975870331,-68.0319000997964,-68.0948005644774,-67.9798366257326,-68.0501369866226,-67.9374017094583,-68.0442673817386,-67.8034327853946,-67.75295518839,-67.7180346034478,-67.6151403324387,-67.4393007416981,-67.4160842433853,-67.5041066625577,-67.4185550888501,-67.4779500777908,-67.4394348623562,-67.3456056765996,-67.2740952251524,-67.1659056488403,-67.1506607561156],"lat":[45.1219899059758,44.9592956420457,44.904581199872,44.8286551275156,44.7806250123542,44.6537812158742,44.6535210559882,44.6914002214265,44.5983332285021,44.5402396088361,44.5540098477743,44.5360772060716,44.4523993326664,44.4712283914674,44.5053274161483,44.4848123430798,44.5883644735857,44.5917442727265,44.6762575380716,44.6747582773664,44.9408935003337,44.9554474307804,45.2559714702251,45.2683404617007,45.6357807631594,45.678113625476,45.6592891772344,45.6812994702931,45.6051989219319,45.59256143012,45.5035545269822,45.4858159950153,45.3758523375688,45.2802804121216,45.1895839720417,45.1222522416315,45.1827832931569,45.1562643909382,45.1219899059758]}]],[[{"lng":[-70.8428755535817,-70.8126658207695,-70.8291320455279,-70.7969669174432,-70.6349296323412,-70.7199105845544,-70.5522701227431,-70.5104105421308,-70.5247769937588,-70.4176409561967,-70.3603211852718,-70.3631059114116,-70.3085022262742,-70.2900544452034,-70.1553480906383,-70.1074724551224,-70.144551921604,-70.1420187040757,-70.1516776708363,-70.1476796422889,-70.136685478216,-70.1295972351082,-70.0317259355667,-70.0239360067448,-70.0317562409298,-70.0296198941475,-70.0191980092982,-70.0031070530014,-70.0161687162882,-69.9966047653838,-69.9603562874987,-69.958471449328,-69.9738221777052,-69.9415176967544,-69.9216111657372,-69.9510762154826,-70.0286924982336,-70.0678307090463,-70.0281184576726,-70.041103399177,-70.1244255860475,-70.1991415678468,-70.231269345219,-70.2472614594085,-70.2713022117928,-70.282861506132,-70.3040409660062,-70.2810081130132,-70.5435626925789,-70.5126784193691,-70.621690073983,-70.7705036527628,-70.7792539248677,-70.7964349417622,-70.8073832592603,-70.8239232011668,-70.7842192902435,-70.8428755535817],"lat":[45.2781374344223,45.3546780062945,45.390726157959,45.425172166096,45.3919670201156,45.5129543699375,45.6606641600491,45.5136548123547,45.5126513681109,45.1450127607892,45.1521540512333,45.1604547160799,45.1649104851198,45.1123024469935,45.126798305112,44.9485849496765,44.9432595462267,44.9198908994501,44.920169346162,44.8999516282799,44.9005505865839,44.8555833334499,44.8655134425529,44.8337640936887,44.8321695135509,44.8138362712112,44.8158123362954,44.7614421837678,44.7581767161421,44.6758574554751,44.6802446359667,44.6687740819471,44.6591954632516,44.6408703541462,44.6087628839574,44.5777040311348,44.5891626184213,44.5341786916345,44.5115505836015,44.486835705252,44.4865416655242,44.4795682719719,44.4663314592278,44.5014677561902,44.5071592069827,44.5417080461379,44.5413838564591,44.5754328902419,44.6098681231387,44.6236694445005,44.7930913436198,44.7360427150373,44.8490243722131,44.9211284461481,44.9213914552563,45.0081057188249,45.0149269121093,45.2781374344223]}]],[[{"lng":[-71.00859652032,-71.0287261195311,-71.087509250962,-70.9593819057968,-70.8764440530948,-70.8428755535817,-70.7842192902435,-70.8239232011668,-70.8073832592603,-70.7964349417622,-70.7792539248677,-70.7705036527628,-70.621690073983,-70.5126784193691,-70.5435626925789,-70.2810081130132,-70.3040409660062,-70.282861506132,-70.2713022117928,-70.2472614594085,-70.231269345219,-70.2727964993103,-70.2603743050863,-70.3190657951714,-70.481373238339,-70.5438391707373,-70.6084839810342,-70.5888726294337,-70.6105822518475,-70.6227513315348,-70.8220499671009,-70.8602592796827,-70.8726573850283,-70.8513011697716,-70.8482491865923,-70.804149806531,-70.7185841421247,-70.7468583724156,-70.7318202296123,-70.7539614314786,-70.7555404186005,-70.7771165938088,-70.800547768061,-70.7841356267198,-70.9104967649645,-70.9415338082865,-70.9844425761095,-71.00859652032],"lat":[44.2821463413425,44.6685381145474,45.3014691967229,45.3388657557299,45.2254453701441,45.2781374344223,45.0149269121093,45.0081057188249,44.9213914552563,44.9211284461481,44.8490243722131,44.7360427150373,44.7930913436198,44.6236694445005,44.6098681231387,44.5754328902419,44.5413838564591,44.5417080461379,44.5071592069827,44.5014677561902,44.4663314592278,44.4451413277215,44.3685974403908,44.2183359905128,44.0345038135482,44.009081240216,44.05702007666,44.1216648869569,44.1567737795825,44.1684809226502,44.0790261735915,44.0927013003132,44.0861552382823,44.066045065586,44.0495659416218,44.0382358283531,43.9666552860406,43.9468421059024,43.9291539792659,43.9046327962199,43.8714044938338,43.8714804903597,43.8592884096788,43.8169700524933,43.7999334652607,43.7865326927318,43.7911635594249,44.2821463413425]}]],[[{"lng":[-69.4146409319936,-69.5047286746101,-69.4402439905991,-69.3925757266531,-69.3687576280303,-69.4138931406844,-69.4016350098532,-69.460900074263,-69.4327713097148,-69.4735046187058,-69.4728642689743,-69.4624731039204,-69.4028421993842,-69.3955572045347,-69.3827629018954,-69.34466947495,-69.3240541092611,-69.2657354010438,-69.20874292804,-69.1800227685777,-68.8974313708356,-68.8919760946589,-68.8628237858996,-68.8318934588989,-68.8240041181253,-68.8238128576118,-68.8606089041936,-68.8079028528248,-68.8116777613743,-68.9591794546594,-68.9850277535877,-69.0214822561375,-69.0391830747638,-69.1306479241606,-69.2638687978949,-69.3454959565951,-69.392408762234,-69.4146409319936],"lat":[44.3307536571113,44.34158194465,44.4635360614559,44.4577920295634,44.5437052990743,44.5498308677172,44.6357097911499,44.6427621858623,44.6692017760966,44.675155873369,44.6943167370426,44.6957893704716,44.7028853841853,44.7437477888425,44.7519875321388,44.7538610252249,44.7170578296856,44.7232306436125,44.7285108739399,44.6443454209155,44.6932405081234,44.6889223824163,44.7001375943256,44.7007748358147,44.6863059676007,44.6640894944651,44.6109704094898,44.5696542014471,44.4945934637654,44.4303318479482,44.2711125989834,44.2440933215478,44.2524778053302,44.2599653539739,44.3651790990447,44.3132952295857,44.3473284631364,44.3307536571113]}]],[[{"lng":[-70.1244255860475,-70.041103399177,-70.0281184576726,-70.0678307090463,-70.0286924982336,-69.9510762154826,-69.9216111657372,-69.8521814235339,-69.8233181813147,-69.8167637270293,-69.7984447826045,-69.7786921613885,-69.6025020127131,-69.5789425716592,-69.5767153087878,-69.6158402577664,-69.6255230025811,-69.4789760059387,-69.4624731039204,-69.4728642689743,-69.4735046187058,-69.4327713097148,-69.460900074263,-69.4016350098532,-69.4138931406844,-69.3687576280303,-69.3925757266531,-69.4402439905991,-69.5047286746101,-69.521803804048,-69.5437918731738,-69.645484238664,-69.6663049037611,-69.655953006169,-69.7501220264243,-69.7554626084577,-69.8539836860659,-69.8748813319655,-69.8959241327837,-69.9989009276277,-70.0227277811331,-70.0206829202845,-70.010467008296,-70.0063240320463,-69.9975424703016,-69.9931324442286,-70.0745241535695,-70.0735558324644,-70.1206163832238,-70.1014359376233,-70.1244255860475],"lat":[44.4865416655242,44.486835705252,44.5115505836015,44.5341786916345,44.5891626184213,44.5777040311348,44.6087628839574,44.6207756708577,44.6098355902019,44.5808673929988,44.5761869498399,44.6047777546158,44.5794610687403,44.6060796937349,44.6302072178852,44.6607202633484,44.6998506517512,44.7182725826063,44.6957893704716,44.6943167370426,44.675155873369,44.6692017760966,44.6427621858623,44.6357097911499,44.5498308677172,44.5437052990743,44.4577920295634,44.4635360614559,44.34158194465,44.2864872090229,44.2630422030921,44.2810075331436,44.2351516335172,44.1276148917102,44.1406935467219,44.1572870022011,44.1731715712048,44.1546672201229,44.1124437161336,44.1279011608321,44.1345459613622,44.1586541626059,44.158806777306,44.1751027221868,44.172558418594,44.1824572380572,44.2090598037996,44.2920502894056,44.3741786003833,44.3850274023216,44.4865416655242]}]],[[{"lng":[-69.9989009276277,-70.0184711986249,-70.0327993670678,-70.0213172089434,-70.0378041553176,-70.0340425604062,-70.072700029733,-70.0894620555566,-70.1109918661495,-70.1949849153306,-70.1905371759169,-70.3102828347177,-70.3631700966165,-70.3885841740862,-70.401722092919,-70.4641012017472,-70.481373238339,-70.3190657951714,-70.2603743050863,-70.2727964993103,-70.231269345219,-70.1991415678468,-70.1244255860475,-70.1014359376233,-70.1206163832238,-70.0735558324644,-70.0745241535695,-69.9931324442286,-69.9975424703016,-70.0063240320463,-70.010467008296,-70.0206829202845,-70.0227277811331,-69.9989009276277],"lat":[44.1279011608321,44.044128900467,44.0276878524718,44.0063683144749,43.9854373067738,43.9734708844888,43.9317688917644,43.9386463960397,43.917852617239,43.949924757073,43.9611931717307,44.0393420000071,43.9906553204499,44.0032013781322,43.995354568475,44.0189170141632,44.0345038135482,44.2183359905128,44.3685974403908,44.4451413277215,44.4663314592278,44.4795682719719,44.4865416655242,44.3850274023216,44.3741786003833,44.2920502894056,44.2090598037996,44.1824572380572,44.172558418594,44.1751027221868,44.158806777306,44.1586541626059,44.1345459613622,44.1279011608321]}]],[[{"lng":[-68.0501369866226,-67.9798366257326,-68.0948005644774,-68.0319000997964,-68.0143975870331,-67.9949024836971,-68.0112605416211,-67.986523698359,-68.016392975024,-68.0743791531122,-68.1362647248567,-68.2456142454157,-68.3637657385109,-68.4285712449382,-68.5521861992483,-68.5300756653733,-68.5594267980359,-68.7403098746437,-68.8128516927119,-68.8137677435412,-68.7413487010464,-68.7452790217143,-68.8235520760772,-68.8238128576118,-68.8240041181253,-68.7962935157835,-68.7656147491982,-68.7663622296832,-68.7439616967955,-68.7181055754573,-68.6842837023874,-68.6494463147326,-68.6053095321548,-68.4451095291154,-68.4996991235541,-68.3763047508439,-68.394538736644,-68.2753564985761,-68.3005641369487,-68.0501369866226],"lat":[45.2559714702251,44.9554474307804,44.9408935003337,44.6747582773664,44.6762575380716,44.5917442727265,44.5883644735857,44.4848123430798,44.3849565861997,44.3813743886768,44.475237143451,44.490648016318,44.4313868372113,44.4653064126995,44.3990492534793,44.2898360811521,44.2598872334824,44.3463301474925,44.3274322929271,44.4139901601006,44.5072848835824,44.5523206216564,44.608906847383,44.6640894944651,44.6863059676007,44.6870575924088,44.6762623558473,44.6666990193435,44.6653601957484,44.6999819749911,44.7210274178153,44.7059329122171,44.7429960086223,44.7652354827514,44.9800582866187,44.9955238127473,45.0868371353288,45.1033141871315,45.225625285573,45.2559714702251]}],[{"lng":[-68.3879209778224,-68.3502537427093,-68.3554494806484,-68.2387092331955,-68.1647688096706,-68.3047050928408,-68.3207117121614,-68.4028903248613,-68.3879209778224],"lat":[44.3772530665156,44.3989509294124,44.4288577640061,44.437563329225,44.3344957218999,44.2900314341848,44.2250794777381,44.2708014639226,44.3772530665156]}]],[[{"lng":[-69.3464537614802,-69.3286010016063,-69.2825031771158,-69.3018433863739,-69.2975703819852,-69.3327483293953,-69.4033812204145,-69.4078519090177,-69.4388193795147,-69.4443346965731,-69.4401384139668,-69.4186617025143,-69.4146409319936,-69.392408762234,-69.3454959565951,-69.2638687978949,-69.1306479241606,-69.0391830747638,-69.0214822561375,-69.074458413768,-69.219140724011,-69.2936504739293,-69.3464537614802],"lat":[44.0159695715356,44.0111327837857,44.0701680454765,44.0945737055146,44.1286344470103,44.2106289999581,44.2140039295192,44.2232847785959,44.2375813983788,44.3075832125896,44.3225022061022,44.3185658761658,44.3307536571113,44.3473284631364,44.3132952295857,44.3651790990447,44.2599653539739,44.2524778053302,44.2440933215478,44.0690660181456,43.9467875562489,43.9421907766137,44.0159695715356]}]],[[{"lng":[-69.8000128390742,-69.7667552156018,-69.7772762533827,-69.7501220264243,-69.655953006169,-69.6663049037611,-69.645484238664,-69.5437918731738,-69.521803804048,-69.5047286746101,-69.4146409319936,-69.4186617025143,-69.4401384139668,-69.4443346965731,-69.4388193795147,-69.4078519090177,-69.4033812204145,-69.3327483293953,-69.2975703819852,-69.3018433863739,-69.2825031771158,-69.3286010016063,-69.3464537614802,-69.3944884353971,-69.4832330546832,-69.5893265359517,-69.6644528575473,-69.6552447931459,-69.6129323416209,-69.7206355816107,-69.7047589904291,-69.8000128390742],"lat":[44.0268667066427,44.0477322340379,44.0741483052384,44.1406935467219,44.1276148917102,44.2351516335172,44.2810075331436,44.2630422030921,44.2864872090229,44.34158194465,44.3307536571113,44.3185658761658,44.3225022061022,44.3075832125896,44.2375813983788,44.2232847785959,44.2140039295192,44.2106289999581,44.1286344470103,44.0945737055146,44.0701680454765,44.0111327837857,44.0159695715356,44.0251280594712,43.8871600707793,43.8448627978378,43.8522244626656,43.9802499092851,44.033612835874,43.93797952264,44.0110823784553,44.0268667066427]}]],[[{"lng":[-70.7841356267198,-70.800547768061,-70.7771165938088,-70.7555404186005,-70.7539614314786,-70.7318202296123,-70.7468583724156,-70.7185841421247,-70.804149806531,-70.8482491865923,-70.8513011697716,-70.8726573850283,-70.8602592796827,-70.8220499671009,-70.6227513315348,-70.6105822518475,-70.5888726294337,-70.6084839810342,-70.5438391707373,-70.481373238339,-70.4641012017472,-70.401722092919,-70.3885841740862,-70.3631700966165,-70.3102828347177,-70.1905371759169,-70.1949849153306,-70.1109918661495,-70.0894620555566,-70.072700029733,-70.0340425604062,-70.0296782773,-69.9742338644066,-69.9143113031284,-69.8570440614995,-69.8603320638824,-69.8867908734153,-69.9031321986346,-69.9729033812618,-69.9995000931478,-69.9873704363344,-70.0264027596906,-70.156628531081,-70.2357978471302,-70.2222392276931,-70.341610602309,-70.4927678994408,-70.4656679631159,-70.5551785569291,-70.5723830928575,-70.5966833834794,-70.6068916802742,-70.6211668013807,-70.6501287820991,-70.6466807052343,-70.6643206023102,-70.6965481542624,-70.7541895764683,-70.7777192820035,-70.7841356267198],"lat":[43.8169700524933,43.8592884096788,43.8714804903597,43.8714044938338,43.9046327962199,43.9291539792659,43.9468421059024,43.9666552860406,44.0382358283531,44.0495659416218,44.066045065586,44.0861552382823,44.0927013003132,44.0790261735915,44.1684809226502,44.1567737795825,44.1216648869569,44.05702007666,44.009081240216,44.0345038135482,44.0189170141632,43.995354568475,44.0032013781322,43.9906553204499,44.0393420000071,43.9611931717307,43.949924757073,43.917852617239,43.9386463960397,43.9317688917644,43.9734708844888,43.9610314395196,43.9201504890162,43.9233278897749,43.9557441638428,43.9225610345792,43.8767134235991,43.7907323426006,43.7688475707295,43.7862077777964,43.8457387523406,43.8456010572037,43.7898104897189,43.6857964225933,43.5772404363104,43.5349087136827,43.6109287585666,43.6457372913716,43.7155249994873,43.6881817913931,43.6961007640772,43.6817844587594,43.7003730432094,43.7038441728717,43.7611588151967,43.7893982331731,43.8047862086547,43.7930026546288,43.8049651916109,43.8169700524933]}]],[[{"lng":[-69.8867908734153,-69.8603320638824,-69.8570440614995,-69.9143113031284,-69.9742338644066,-70.0296782773,-70.0340425604062,-70.0378041553176,-70.0213172089434,-70.0327993670678,-70.0184711986249,-69.9989009276277,-69.8959241327837,-69.8748813319655,-69.8539836860659,-69.7554626084577,-69.7501220264243,-69.7772762533827,-69.8599284586111,-69.7915280108674,-69.8303921783115,-69.8517853298484,-69.846155681275,-69.8867908734153],"lat":[43.8767134235991,43.9225610345792,43.9557441638428,43.9233278897749,43.9201504890162,43.9610314395196,43.9734708844888,43.9854373067738,44.0063683144749,44.0276878524718,44.044128900467,44.1279011608321,44.1124437161336,44.1546672201229,44.1731715712048,44.1572870022011,44.1406935467219,44.0741483052384,44.000001079988,43.7560849721624,43.7279862539571,43.7443279936087,43.8423439818324,43.8767134235991]}],[{"lng":[-69.8000128390742,-69.7047589904291,-69.7206355816107,-69.7485283787592,-69.7246713234988,-69.7503594443371,-69.7776729687166,-69.8000128390742],"lat":[44.0268667066427,44.0110823784553,43.93797952264,43.8933754158225,43.7844771602511,43.7617041045157,43.7912707419825,44.0268667066427]}]],[[{"lng":[-70.9642682700125,-70.9496195381735,-70.9565243949817,-70.9738741894367,-70.9844425761095,-70.9415338082865,-70.9104967649645,-70.7841356267198,-70.7777192820035,-70.7541895764683,-70.6965481542624,-70.6643206023102,-70.6466807052343,-70.6501287820991,-70.6211668013807,-70.6068916802742,-70.5966833834794,-70.5723830928575,-70.5551785569291,-70.4656679631159,-70.4927678994408,-70.341610602309,-70.365925605278,-70.45697679942,-70.5389410988088,-70.665672117895,-70.8186681476027,-70.83054816075,-70.8132073801978,-70.9010858877487,-70.9058011432221,-70.9696996127229,-70.9790994556783,-70.9614829222242,-70.9707912274419,-70.9592784013261,-70.9642682700125],"lat":[43.5319898668848,43.5489536176379,43.5641434944728,43.5718299188238,43.7911635594249,43.7865326927318,43.7999334652607,43.8169700524933,43.8049651916109,43.7930026546288,43.8047862086547,43.7893982331731,43.7611588151967,43.7038441728717,43.7003730432094,43.6817844587594,43.6961007640772,43.6881817913931,43.7155249994873,43.6457372913716,43.6109287585666,43.5349087136827,43.4303037178793,43.3494706632996,43.335718193147,43.0910505641212,43.1218710665584,43.1591741192742,43.2352227081839,43.2810200174417,43.3020692937648,43.3663799680073,43.3961839197787,43.4381263868541,43.4702114776979,43.5163879925244,43.5319898668848]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}],"limits":{"lat":[43.0910505641212,47.4533345006126],"lng":[-71.087509250962,-66.969271036002]}},"evals":[],"jsHooks":[]}</script>
<p>Next, we’ll explore other transformations using a <code>tmap</code> dataset of the world</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="coordinate-systems-in-r.html#cb171-1"></a><span class="kw">library</span>(tmap)</span>
<span id="cb171-2"><a href="coordinate-systems-in-r.html#cb171-2"></a><span class="kw">data</span>(World)  <span class="co"># The data is stored as an sf object</span></span>
<span id="cb171-3"><a href="coordinate-systems-in-r.html#cb171-3"></a> </span>
<span id="cb171-4"><a href="coordinate-systems-in-r.html#cb171-4"></a><span class="co"># Let&#39;s check its current coordinate system</span></span>
<span id="cb171-5"><a href="coordinate-systems-in-r.html#cb171-5"></a><span class="kw">st_crs</span>(World)</span></code></pre></div>
<pre><code>Coordinate Reference System:
  User input: +proj=eck4 +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs 
  wkt:
PROJCRS[&quot;unknown&quot;,
    BASEGEOGCRS[&quot;unknown&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8901]]],
    CONVERSION[&quot;unknown&quot;,
        METHOD[&quot;Eckert IV&quot;],
        PARAMETER[&quot;Longitude of natural origin&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;False easting&quot;,0,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,0,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]</code></pre>
<p>The following chunk transforms the world map to an Azimuthal equidistant projection centered on latitude <code>0</code> and longitude <code>0</code>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="coordinate-systems-in-r.html#cb173-1"></a>World.ae &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World, <span class="st">&quot;+proj=aeqd +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb173-2"><a href="coordinate-systems-in-r.html#cb173-2"></a></span>
<span id="cb173-3"><a href="coordinate-systems-in-r.html#cb173-3"></a><span class="kw">tm_shape</span>(World.ae) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>() </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-12-1.png" width="240" /></p>
<p>The following chunk transforms the world map to an Azimuthal equidistant projection centered on Maine.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="coordinate-systems-in-r.html#cb174-1"></a>World.aemaine &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World, <span class="st">&quot;+proj=aeqd +lat_0=44.5 +lon_0=-69.8 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb174-2"><a href="coordinate-systems-in-r.html#cb174-2"></a></span>
<span id="cb174-3"><a href="coordinate-systems-in-r.html#cb174-3"></a><span class="kw">tm_shape</span>(World.aemaine) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>()  </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-13-1.png" width="240" /></p>
<p>The following chunk transforms the world map to a World Robinson projection.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="coordinate-systems-in-r.html#cb175-1"></a>World.robin &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World,<span class="st">&quot;+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb175-2"><a href="coordinate-systems-in-r.html#cb175-2"></a><span class="kw">tm_shape</span>(World.robin) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>()  </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-14-1.png" width="432" /></p>
<p>The following chunk transforms the world map to a World sinusoidal projection.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="coordinate-systems-in-r.html#cb176-1"></a>World.sin &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World,<span class="st">&quot;+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb176-2"><a href="coordinate-systems-in-r.html#cb176-2"></a><span class="kw">tm_shape</span>(World.sin) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>()  </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-15-1.png" width="432" /></p>
<p>The following chunk transforms the world map to a World Mercator projection.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="coordinate-systems-in-r.html#cb177-1"></a>World.mercator &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World,<span class="st">&quot;+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb177-2"><a href="coordinate-systems-in-r.html#cb177-2"></a><span class="kw">tm_shape</span>(World.mercator) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>()  </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-16-1.png" width="240" /></p>
<div id="example-of-a-failed-transformation" class="section level3 unnumbered">
<h3>Example of a failed transformation</h3>
<p>An issue that can come up when transforming spatial data is when the location of the tangent line(s) or points in the CS definition forces polygon features to be split across the 180° meridian. For example, re-centering the mercator projection to -69° will create the following map.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="coordinate-systems-in-r.html#cb178-1"></a>World.mercator2 &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World, <span class="st">&quot;+proj=merc +lon_0=-69 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb178-2"><a href="coordinate-systems-in-r.html#cb178-2"></a></span>
<span id="cb178-3"><a href="coordinate-systems-in-r.html#cb178-3"></a><span class="kw">tm_shape</span>(World.mercator2) <span class="op">+</span><span class="st"> </span><span class="kw">tm_borders</span>()</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-17-1.png" width="288" /></p>
<p>The polygons are split and R does not know how to piece them together.</p>
<p>One solution is to make use of <code>maptools</code>’ <code>nowrapSpatialPolygons()</code> function. This function will split the polygon at a given longitude however, it requires that the object be of <code>Spatial*</code> type and that it be in a geographic (lat/long) reference system. The following chunk is a sample workflow.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="coordinate-systems-in-r.html#cb179-1"></a><span class="kw">library</span>(maptools)</span>
<span id="cb179-2"><a href="coordinate-systems-in-r.html#cb179-2"></a></span>
<span id="cb179-3"><a href="coordinate-systems-in-r.html#cb179-3"></a><span class="co"># Convert to lat/long reference system</span></span>
<span id="cb179-4"><a href="coordinate-systems-in-r.html#cb179-4"></a>wld.ll &lt;-<span class="st"> </span><span class="kw">st_transform</span>(World, <span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>)</span>
<span id="cb179-5"><a href="coordinate-systems-in-r.html#cb179-5"></a></span>
<span id="cb179-6"><a href="coordinate-systems-in-r.html#cb179-6"></a><span class="co"># Convert to a spatial object, then split the polygons at a given longitude (111 in this example)</span></span>
<span id="cb179-7"><a href="coordinate-systems-in-r.html#cb179-7"></a>wld.sp &lt;-<span class="st"> </span><span class="kw">nowrapSpatialPolygons</span>(<span class="kw">as</span>(wld.ll, <span class="st">&quot;Spatial&quot;</span>), <span class="dt">offset =</span> <span class="dv">111</span>)</span>
<span id="cb179-8"><a href="coordinate-systems-in-r.html#cb179-8"></a></span>
<span id="cb179-9"><a href="coordinate-systems-in-r.html#cb179-9"></a><span class="co"># Now convert back to an sf object, reproject to a new longitude center at -69 degrees </span></span>
<span id="cb179-10"><a href="coordinate-systems-in-r.html#cb179-10"></a><span class="co"># then plot it</span></span>
<span id="cb179-11"><a href="coordinate-systems-in-r.html#cb179-11"></a>wld.sf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(wld.sp)</span>
<span id="cb179-12"><a href="coordinate-systems-in-r.html#cb179-12"></a>wld.merc2.sf &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wld.sf, <span class="st">&quot;+proj=merc +lon_0=-69 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb179-13"><a href="coordinate-systems-in-r.html#cb179-13"></a><span class="kw">tm_shape</span>(wld.merc2.sf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_borders</span>()</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-18-1.png" width="288" /></p>
<p>You’ll note that the Antarctica polygon is deformed in this transformation. In such a case, you might need to remove the Antarctica polygon before proceeding with the <code>nowrapSpatialPolygons</code> or you can adopt another projection. In the following example, a Robinson projection is used <em>in lieu of</em> a Mercator.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="coordinate-systems-in-r.html#cb180-1"></a>wld.rob.sf &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wld.sf,<span class="st">&quot;+proj=robin +lon_0=-69 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb180-2"><a href="coordinate-systems-in-r.html#cb180-2"></a><span class="kw">tm_shape</span>(wld.rob.sf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_borders</span>()</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-19-1.png" width="384" /></p>
<p>One downside to the the <code>nowwrapSpatialPolygons</code> solution is the loss of the attribute table.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="coordinate-systems-in-r.html#cb181-1"></a><span class="kw">head</span>(<span class="kw">data.frame</span>(wld.rob.sf), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>                        geometry
1 MULTIPOLYGON (((11566048 38...
2 MULTIPOLYGON (((8046523 -62...
3 MULTIPOLYGON (((7724367 447...
4 MULTIPOLYGON (((11102301 25...</code></pre>
<p>A (not so perfect) solution is to create a centroid from the polygons prior to projecting them, then performing a spatial join of the transformed points to the transformed polygons.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="coordinate-systems-in-r.html#cb183-1"></a><span class="co"># Create centroid from polygons</span></span>
<span id="cb183-2"><a href="coordinate-systems-in-r.html#cb183-2"></a>pt &lt;-<span class="st"> </span><span class="kw">st_centroid</span>(World, <span class="dt">of_largest_polygon =</span> <span class="ot">TRUE</span>)</span>
<span id="cb183-3"><a href="coordinate-systems-in-r.html#cb183-3"></a></span>
<span id="cb183-4"><a href="coordinate-systems-in-r.html#cb183-4"></a><span class="co"># Transform points to the recentered Robinson projection</span></span>
<span id="cb183-5"><a href="coordinate-systems-in-r.html#cb183-5"></a>pt.rob &lt;-<span class="st"> </span><span class="kw">st_transform</span>(pt,<span class="st">&quot;+proj=robin +lon_0=-69 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb183-6"><a href="coordinate-systems-in-r.html#cb183-6"></a></span>
<span id="cb183-7"><a href="coordinate-systems-in-r.html#cb183-7"></a><span class="co"># Perform the spatial join (joining the point attribute values to the wld.rob.sf polygons)</span></span>
<span id="cb183-8"><a href="coordinate-systems-in-r.html#cb183-8"></a>wld.rob.df.sf &lt;-<span class="st"> </span><span class="kw">st_join</span>(wld.rob.sf, pt.rob, <span class="dt">join =</span> st_contains)</span>
<span id="cb183-9"><a href="coordinate-systems-in-r.html#cb183-9"></a></span>
<span id="cb183-10"><a href="coordinate-systems-in-r.html#cb183-10"></a><span class="co"># Map the output</span></span>
<span id="cb183-11"><a href="coordinate-systems-in-r.html#cb183-11"></a><span class="kw">tm_shape</span>(wld.rob.df.sf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;pop_est_dens&quot;</span>, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>) <span class="op">+</span></span>
<span id="cb183-12"><a href="coordinate-systems-in-r.html#cb183-12"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-21-1.png" width="576" /></p>
<p>While this solution appears to work for most polygons a few, such as Norway, have missing values. To see why, let’s zoom in on Norway using the unprojected layers and overlapping the map with the centroids.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="coordinate-systems-in-r.html#cb184-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb184-2"><a href="coordinate-systems-in-r.html#cb184-2"></a></span>
<span id="cb184-3"><a href="coordinate-systems-in-r.html#cb184-3"></a><span class="co"># Extract the extent for the Norwar/Sweden region</span></span>
<span id="cb184-4"><a href="coordinate-systems-in-r.html#cb184-4"></a>nor.bb &lt;-<span class="st"> </span>World <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(name <span class="op">==</span><span class="st"> &quot;Norway&quot;</span> <span class="op">|</span><span class="st"> </span>name <span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_bbox</span>()</span>
<span id="cb184-5"><a href="coordinate-systems-in-r.html#cb184-5"></a></span>
<span id="cb184-6"><a href="coordinate-systems-in-r.html#cb184-6"></a><span class="co"># Plot the data zoomed in on the region. Add the point layer for reference</span></span>
<span id="cb184-7"><a href="coordinate-systems-in-r.html#cb184-7"></a><span class="kw">tm_shape</span>(World, <span class="dt">bbox=</span>nor.bb) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;pop_est_dens&quot;</span>, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>) <span class="op">+</span></span>
<span id="cb184-8"><a href="coordinate-systems-in-r.html#cb184-8"></a><span class="st">  </span><span class="kw">tm_shape</span>(pt) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>() <span class="op">+</span></span>
<span id="cb184-9"><a href="coordinate-systems-in-r.html#cb184-9"></a><span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;name&quot;</span>, <span class="dt">just=</span><span class="st">&quot;left&quot;</span>, <span class="dt">xmod=</span><span class="fl">0.5</span>, <span class="dt">size=</span><span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb184-10"><a href="coordinate-systems-in-r.html#cb184-10"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-22-1.png" width="480" /></p>
<p>You’ll notice that the Norway point falls inside the Sweden polygon. This is a result of the “C” shaped nature of Norway and <code>st_centroid</code>’s use of the geometric center in computing the centroid and not the “center of mass”.</p>
<p>An alternate solution is the use of <code>st_point_on_surface()</code> which will place a point <em>inside</em> the polygons.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="coordinate-systems-in-r.html#cb185-1"></a>pt &lt;-<span class="st"> </span><span class="kw">st_point_on_surface</span>(World)</span>
<span id="cb185-2"><a href="coordinate-systems-in-r.html#cb185-2"></a></span>
<span id="cb185-3"><a href="coordinate-systems-in-r.html#cb185-3"></a>pt.rob &lt;-<span class="st"> </span><span class="kw">st_transform</span>(pt,<span class="st">&quot;+proj=robin +lon_0=-69 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>)</span>
<span id="cb185-4"><a href="coordinate-systems-in-r.html#cb185-4"></a>wld.rob.df.sf &lt;-<span class="st"> </span><span class="kw">st_join</span>(wld.rob.sf, pt.rob, <span class="dt">join =</span> st_contains)</span>
<span id="cb185-5"><a href="coordinate-systems-in-r.html#cb185-5"></a><span class="kw">tm_shape</span>(wld.rob.df.sf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;pop_est_dens&quot;</span>, <span class="dt">style=</span><span class="st">&quot;quantile&quot;</span>) <span class="op">+</span></span>
<span id="cb185-6"><a href="coordinate-systems-in-r.html#cb185-6"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
</div>
</div>
<div id="a-note-about-containment" class="section level2 unnumbered">
<h2>A note about containment</h2>
<p>While in theory, a point completely enclosed by a bounded area should always remain bounded by that area in any projection, this is not always the case in practice. This is because the transformation applies to the vertices that define the line segments and not the lines themselves. So if a point is inside of a polygon and very close to one of its boundaries in its native projection, it may find itself on the other side of that line segment in another projection hence outside of that polygon. In the following example, a polygon layer and point layer are created in a Miller coordinate system where the points are enclosed in the polygons.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="coordinate-systems-in-r.html#cb186-1"></a><span class="co"># Define a dew projections</span></span>
<span id="cb186-2"><a href="coordinate-systems-in-r.html#cb186-2"></a>miller &lt;-<span class="st"> &quot;+proj=mill +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span></span>
<span id="cb186-3"><a href="coordinate-systems-in-r.html#cb186-3"></a>lambert &lt;-<span class="st"> &quot;+proj=lcc +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs&quot;</span></span>
<span id="cb186-4"><a href="coordinate-systems-in-r.html#cb186-4"></a></span>
<span id="cb186-5"><a href="coordinate-systems-in-r.html#cb186-5"></a><span class="co"># Subset the World data layer</span></span>
<span id="cb186-6"><a href="coordinate-systems-in-r.html#cb186-6"></a>wld.mil &lt;-<span class="st">  </span>World <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>( iso_a3  <span class="op">==</span><span class="st"> &quot;CAN&quot;</span> <span class="op">|</span><span class="st">  </span>iso_a3 <span class="op">==</span><span class="st"> &quot;USA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>( miller)</span>
<span id="cb186-7"><a href="coordinate-systems-in-r.html#cb186-7"></a></span>
<span id="cb186-8"><a href="coordinate-systems-in-r.html#cb186-8"></a><span class="co"># Create polygon and point layers in the Miller projection  </span></span>
<span id="cb186-9"><a href="coordinate-systems-in-r.html#cb186-9"></a>sf1 &lt;-<span class="st"> </span><span class="kw">st_sfc</span>( <span class="kw">st_polygon</span>(<span class="kw">list</span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">13340256</span>,<span class="op">-</span><span class="dv">13340256</span>,<span class="op">-</span><span class="dv">6661069</span>, <span class="dv">-6661069</span>, <span class="dv">-13340256</span>),</span>
<span id="cb186-10"><a href="coordinate-systems-in-r.html#cb186-10"></a>                               <span class="kw">c</span>(<span class="dv">7713751</span>, <span class="dv">5326023</span>, <span class="dv">5326023</span>,<span class="dv">7713751</span>, <span class="dv">7713751</span> )))), <span class="dt">crs =</span> miller) </span>
<span id="cb186-11"><a href="coordinate-systems-in-r.html#cb186-11"></a></span>
<span id="cb186-12"><a href="coordinate-systems-in-r.html#cb186-12"></a>pt1 &lt;-<span class="st"> </span><span class="kw">st_sfc</span>( <span class="kw">st_multipoint</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">11688500</span>,<span class="dv">7633570</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">11688500</span>,<span class="dv">5375780</span>),</span>
<span id="cb186-13"><a href="coordinate-systems-in-r.html#cb186-13"></a>                                  <span class="kw">c</span>(<span class="op">-</span><span class="dv">10018800</span>,<span class="dv">7633570</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">10018800</span>,<span class="dv">5375780</span>),</span>
<span id="cb186-14"><a href="coordinate-systems-in-r.html#cb186-14"></a>                                  <span class="kw">c</span>(<span class="op">-</span><span class="dv">8348960</span>,<span class="dv">7633570</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">8348960</span>,<span class="dv">5375780</span>))),  <span class="dt">crs =</span> miller)</span>
<span id="cb186-15"><a href="coordinate-systems-in-r.html#cb186-15"></a>pt1 &lt;-<span class="st"> </span><span class="kw">st_cast</span>(pt1, <span class="st">&quot;POINT&quot;</span>) <span class="co"># Create single part points</span></span>
<span id="cb186-16"><a href="coordinate-systems-in-r.html#cb186-16"></a></span>
<span id="cb186-17"><a href="coordinate-systems-in-r.html#cb186-17"></a><span class="co"># Plot the data layers in their native projection</span></span>
<span id="cb186-18"><a href="coordinate-systems-in-r.html#cb186-18"></a><span class="kw">tm_shape</span>(wld.mil) <span class="op">+</span><span class="kw">tm_fill</span>(<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb186-19"><a href="coordinate-systems-in-r.html#cb186-19"></a><span class="st">  </span><span class="kw">tm_graticules</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">80</span>,<span class="op">-</span><span class="dv">100</span>, <span class="dv">-120</span>, <span class="dv">-140</span>), </span>
<span id="cb186-20"><a href="coordinate-systems-in-r.html#cb186-20"></a>                <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb186-21"><a href="coordinate-systems-in-r.html#cb186-21"></a>                <span class="dt">labels.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">col=</span><span class="st">&quot;grey90&quot;</span>) <span class="op">+</span></span>
<span id="cb186-22"><a href="coordinate-systems-in-r.html#cb186-22"></a><span class="st">  </span><span class="kw">tm_shape</span>(sf1) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">border.col =</span> <span class="st">&quot;yellow&quot;</span>) <span class="op">+</span></span>
<span id="cb186-23"><a href="coordinate-systems-in-r.html#cb186-23"></a><span class="st">  </span><span class="kw">tm_shape</span>(pt1) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-24-1.png" width="384" /></p>
<p>The points are close to the boundaries, but are inside of the polygon nonetheless. To confirm, we can run <code>st_contains</code> on the dataset:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="coordinate-systems-in-r.html#cb187-1"></a><span class="kw">st_contains</span>(sf1, pt1)</span></code></pre></div>
<pre><code>Sparse geometry binary predicate list of length 1, where the predicate was `contains&#39;
 1: 1, 2, 3, 4, 5, 6</code></pre>
<p>All six points are selected, as expected.</p>
<p>Now, let’s reproject the data into a Lambert conformal projection.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="coordinate-systems-in-r.html#cb189-1"></a><span class="co"># Transform the data</span></span>
<span id="cb189-2"><a href="coordinate-systems-in-r.html#cb189-2"></a>wld.lam &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wld.mil, lambert)</span>
<span id="cb189-3"><a href="coordinate-systems-in-r.html#cb189-3"></a>pt1.lam &lt;-<span class="st"> </span><span class="kw">st_transform</span>(pt1, lambert)</span>
<span id="cb189-4"><a href="coordinate-systems-in-r.html#cb189-4"></a>sf1.lam &lt;-<span class="st"> </span><span class="kw">st_transform</span>(sf1, lambert)</span>
<span id="cb189-5"><a href="coordinate-systems-in-r.html#cb189-5"></a></span>
<span id="cb189-6"><a href="coordinate-systems-in-r.html#cb189-6"></a><span class="co"># Plot the data in the Lambert coordinate system</span></span>
<span id="cb189-7"><a href="coordinate-systems-in-r.html#cb189-7"></a><span class="kw">tm_shape</span>(wld.lam) <span class="op">+</span><span class="kw">tm_fill</span>(<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb189-8"><a href="coordinate-systems-in-r.html#cb189-8"></a><span class="st">  </span><span class="kw">tm_graticules</span>( <span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">80</span>,<span class="op">-</span><span class="dv">100</span>, <span class="dv">-120</span>, <span class="dv">-140</span>), </span>
<span id="cb189-9"><a href="coordinate-systems-in-r.html#cb189-9"></a>                 <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb189-10"><a href="coordinate-systems-in-r.html#cb189-10"></a>                 <span class="dt">labels.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">col=</span><span class="st">&quot;grey90&quot;</span>) <span class="op">+</span></span>
<span id="cb189-11"><a href="coordinate-systems-in-r.html#cb189-11"></a><span class="st">  </span><span class="kw">tm_shape</span>(sf1.lam) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">border.col =</span> <span class="st">&quot;yellow&quot;</span>) <span class="op">+</span></span>
<span id="cb189-12"><a href="coordinate-systems-in-r.html#cb189-12"></a><span class="st">  </span><span class="kw">tm_shape</span>(pt1.lam) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>)   </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-26-1.png" width="384" /></p>
<p>Only three of the points are contained. We can confirm this using the <code>st_contains</code> function:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="coordinate-systems-in-r.html#cb190-1"></a><span class="kw">st_contains</span>(sf1.lam, pt1.lam)</span></code></pre></div>
<pre><code>Sparse geometry binary predicate list of length 1, where the predicate was `contains&#39;
 1: 1, 3, 5</code></pre>
<p>To resolve this problem, one should <em>densify</em> the the polygon by adding more vertices along the line segment. The vertices density will be dictated by the resolution needed to preserve the map’s containment properties and is best determined experimentally.</p>
<p>We’ll use the <code>st_segmentize</code> function to create vertices at 1 km (1000 m) intervals.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="coordinate-systems-in-r.html#cb192-1"></a><span class="co"># Add vertices every 1000 meters along the polygon&#39;s line segments</span></span>
<span id="cb192-2"><a href="coordinate-systems-in-r.html#cb192-2"></a>sf2 &lt;-<span class="st"> </span><span class="kw">st_segmentize</span>(sf1, <span class="dv">1000</span>)</span>
<span id="cb192-3"><a href="coordinate-systems-in-r.html#cb192-3"></a></span>
<span id="cb192-4"><a href="coordinate-systems-in-r.html#cb192-4"></a><span class="co"># Transform the newly densified polygon layer</span></span>
<span id="cb192-5"><a href="coordinate-systems-in-r.html#cb192-5"></a>sf2.lam &lt;-<span class="st"> </span><span class="kw">st_transform</span>(sf2, lambert)</span>
<span id="cb192-6"><a href="coordinate-systems-in-r.html#cb192-6"></a></span>
<span id="cb192-7"><a href="coordinate-systems-in-r.html#cb192-7"></a><span class="co"># Plot the data</span></span>
<span id="cb192-8"><a href="coordinate-systems-in-r.html#cb192-8"></a><span class="kw">tm_shape</span>(wld.lam) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>(<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb192-9"><a href="coordinate-systems-in-r.html#cb192-9"></a><span class="st">  </span><span class="kw">tm_graticules</span>( <span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">80</span>,<span class="op">-</span><span class="dv">100</span>, <span class="dv">-120</span>, <span class="dv">-140</span>), </span>
<span id="cb192-10"><a href="coordinate-systems-in-r.html#cb192-10"></a>                 <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb192-11"><a href="coordinate-systems-in-r.html#cb192-11"></a>                 <span class="dt">labels.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">col=</span><span class="st">&quot;grey90&quot;</span>) <span class="op">+</span></span>
<span id="cb192-12"><a href="coordinate-systems-in-r.html#cb192-12"></a><span class="st">  </span><span class="kw">tm_shape</span>(sf2.lam) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">border.col =</span> <span class="st">&quot;yellow&quot;</span>) <span class="op">+</span></span>
<span id="cb192-13"><a href="coordinate-systems-in-r.html#cb192-13"></a><span class="st">  </span><span class="kw">tm_shape</span>(pt1.lam) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) </span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-28-1.png" width="384" /></p>
<p>Now all points remain contained by the polygon. We can check via:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="coordinate-systems-in-r.html#cb193-1"></a><span class="kw">st_contains</span>(sf2.lam, pt1.lam)</span></code></pre></div>
<pre><code>Sparse geometry binary predicate list of length 1, where the predicate was `contains&#39;
 1: 1, 2, 3, 4, 5, 6</code></pre>
</div>
<div id="creating-tissot-indicatrix-circles" class="section level2 unnumbered">
<h2>Creating Tissot indicatrix circles</h2>
<p>Most projections will distort some aspect of a spatial property, especially area and shape. A nice way to visualize the distortion afforded by a projection is to create geodesic circles.</p>
<p>First, create a point layer that will define the circle centers in a lat/long coordinate system.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="coordinate-systems-in-r.html#cb195-1"></a>tissot.pt &lt;-<span class="st"> </span><span class="kw">st_sfc</span>( <span class="kw">st_multipoint</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">30</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">45</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">60</span>),</span>
<span id="cb195-2"><a href="coordinate-systems-in-r.html#cb195-2"></a>                                  <span class="kw">c</span>(<span class="op">-</span><span class="dv">80</span>,<span class="dv">30</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">80</span>,<span class="dv">45</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">80</span>,<span class="dv">60</span>),</span>
<span id="cb195-3"><a href="coordinate-systems-in-r.html#cb195-3"></a>                                  <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">30</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">45</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">60</span>),</span>
<span id="cb195-4"><a href="coordinate-systems-in-r.html#cb195-4"></a>                                  <span class="kw">c</span>(<span class="op">-</span><span class="dv">120</span>,<span class="dv">30</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">120</span>,<span class="dv">45</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">120</span>,<span class="dv">60</span>) )),  <span class="dt">crs =</span> <span class="st">&quot;+proj=longlat&quot;</span>)</span>
<span id="cb195-5"><a href="coordinate-systems-in-r.html#cb195-5"></a>tissot.pt &lt;-<span class="st"> </span><span class="kw">st_cast</span>(tissot.pt, <span class="st">&quot;POINT&quot;</span>) <span class="co"># Create single part points</span></span></code></pre></div>
<p>Next we’ll construct geodesic circles from these points using the <code>geosphere</code> package.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="coordinate-systems-in-r.html#cb196-1"></a><span class="kw">library</span>(geosphere)</span>
<span id="cb196-2"><a href="coordinate-systems-in-r.html#cb196-2"></a></span>
<span id="cb196-3"><a href="coordinate-systems-in-r.html#cb196-3"></a>cr.pt &lt;-<span class="st"> </span><span class="kw">list</span>() <span class="co"># Create an empty list</span></span>
<span id="cb196-4"><a href="coordinate-systems-in-r.html#cb196-4"></a></span>
<span id="cb196-5"><a href="coordinate-systems-in-r.html#cb196-5"></a><span class="co"># Loop through each point in tissot.pt and generate 360 vertices at 300 km</span></span>
<span id="cb196-6"><a href="coordinate-systems-in-r.html#cb196-6"></a><span class="co"># from each point in all directions at 1 degree increment. These vertices</span></span>
<span id="cb196-7"><a href="coordinate-systems-in-r.html#cb196-7"></a><span class="co"># will be used to approximate the Tissot circles</span></span>
<span id="cb196-8"><a href="coordinate-systems-in-r.html#cb196-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tissot.pt)){</span>
<span id="cb196-9"><a href="coordinate-systems-in-r.html#cb196-9"></a>  cr.pt[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">destPoint</span>( <span class="kw">as</span>(tissot.pt[i], <span class="st">&quot;Spatial&quot;</span>), <span class="dt">b=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">360</span>,<span class="dv">1</span>), <span class="dt">d=</span><span class="dv">300000</span>) )</span>
<span id="cb196-10"><a href="coordinate-systems-in-r.html#cb196-10"></a>}</span>
<span id="cb196-11"><a href="coordinate-systems-in-r.html#cb196-11"></a></span>
<span id="cb196-12"><a href="coordinate-systems-in-r.html#cb196-12"></a><span class="co"># Create a closed polygon from the previously generated vertices</span></span>
<span id="cb196-13"><a href="coordinate-systems-in-r.html#cb196-13"></a>tissot.sfc &lt;-<span class="st"> </span><span class="kw">st_cast</span>( <span class="kw">st_sfc</span>(<span class="kw">st_multipolygon</span>(cr.pt ),<span class="dt">crs =</span> <span class="st">&quot;+proj=longlat&quot;</span>), <span class="st">&quot;POLYGON&quot;</span> )</span></code></pre></div>
<p>We’ll check that these are indeed geodesic circles by computing the geodesic area of each polygon. We’ll use the <code>st_area</code> function from <code>sf</code> which will revert to geodesic area calculation if a lat/long coordinate system is present.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="coordinate-systems-in-r.html#cb197-1"></a>tissot.sf &lt;-<span class="st"> </span><span class="kw">st_sf</span>( <span class="dt">geoArea =</span>  <span class="kw">st_area</span>(tissot.sfc), tissot.sfc )</span></code></pre></div>
<p>The true area of the circles should be <span class="math inline">\(\pi * r^2\)</span> or 2.827433410^{11} square meters in our example. Let’s compute the error in the <code>tissot</code> output. The values will be reported as fractions.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="coordinate-systems-in-r.html#cb198-1"></a>( (pi <span class="op">*</span><span class="st"> </span><span class="dv">300000</span><span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="st">  </span><span class="kw">as.vector</span>(tissot.sf<span class="op">$</span>geoArea) ) <span class="op">/</span><span class="st"> </span>(pi <span class="op">*</span><span class="st"> </span><span class="dv">300000</span><span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code> [1] 0.0002356458 0.0002350269 0.0002344091 0.0002356458 0.0002350269
 [6] 0.0002344091 0.0002356458 0.0002350269 0.0002344091 0.0002356458
[11] 0.0002350269 0.0002344091</code></pre>
<p>In all cases, the error is less than 0.1%. The error is primarily due to the discretization of the circle parameter.</p>
<p>Let’s now take a look at the distortions associated with a few popular coordinate systems. We’ll start by exploring the Mercator projection.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="coordinate-systems-in-r.html#cb200-1"></a><span class="co"># Transform geodesic circles and compute area error as a percentage</span></span>
<span id="cb200-2"><a href="coordinate-systems-in-r.html#cb200-2"></a>tissot.merc &lt;-<span class="st"> </span><span class="kw">st_transform</span>(tissot.sf, <span class="st">&quot;+proj=merc +ellps=WGS84&quot;</span>)</span>
<span id="cb200-3"><a href="coordinate-systems-in-r.html#cb200-3"></a>tissot.merc<span class="op">$</span>area_err &lt;-<span class="st"> </span><span class="kw">round</span>((<span class="kw">st_area</span>(tissot.merc, tissot.merc<span class="op">$</span>geoArea)) <span class="op">/</span><span class="st"> </span></span>
<span id="cb200-4"><a href="coordinate-systems-in-r.html#cb200-4"></a><span class="st">                                </span>tissot.merc<span class="op">$</span>geoArea <span class="op">*</span><span class="st"> </span><span class="dv">100</span> , <span class="dv">2</span>)</span>
<span id="cb200-5"><a href="coordinate-systems-in-r.html#cb200-5"></a></span>
<span id="cb200-6"><a href="coordinate-systems-in-r.html#cb200-6"></a><span class="co"># Plot the map</span></span>
<span id="cb200-7"><a href="coordinate-systems-in-r.html#cb200-7"></a><span class="kw">tm_shape</span>(World, <span class="dt">bbox =</span> <span class="kw">st_bbox</span>(tissot.merc), <span class="dt">projection =</span> <span class="kw">st_crs</span>(tissot.merc)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb200-8"><a href="coordinate-systems-in-r.html#cb200-8"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb200-9"><a href="coordinate-systems-in-r.html#cb200-9"></a><span class="st">  </span><span class="kw">tm_shape</span>(tissot.merc) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">border.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb200-10"><a href="coordinate-systems-in-r.html#cb200-10"></a><span class="st">  </span><span class="kw">tm_graticules</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">80</span>,<span class="op">-</span><span class="dv">100</span>, <span class="dv">-120</span>, <span class="dv">-140</span>), </span>
<span id="cb200-11"><a href="coordinate-systems-in-r.html#cb200-11"></a>                <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">45</span>, <span class="dv">60</span>),</span>
<span id="cb200-12"><a href="coordinate-systems-in-r.html#cb200-12"></a>               <span class="dt">labels.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">col=</span><span class="st">&quot;grey80&quot;</span>) <span class="op">+</span></span>
<span id="cb200-13"><a href="coordinate-systems-in-r.html#cb200-13"></a><span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;area_err&quot;</span>, <span class="dt">size=</span>.<span class="dv">8</span>, <span class="dt">alpha=</span><span class="fl">0.8</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-34-1.png" width="384" /></p>
<p>The mercator projection does a good job at preserving shape, but the area’s distortion increases dramatically poleward.</p>
<p>Next, we’ll explore the Lambert azimuthal equal area projection centered at 45 degrees north and 100 degrees west.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="coordinate-systems-in-r.html#cb201-1"></a><span class="co"># Transform geodesic circles and compute area error as a percentage</span></span>
<span id="cb201-2"><a href="coordinate-systems-in-r.html#cb201-2"></a>tissot.laea &lt;-<span class="st"> </span><span class="kw">st_transform</span>(tissot.sf, <span class="st">&quot;+proj=laea +lat_0=45 +lon_0=-100 +ellps=WGS84&quot;</span>)</span>
<span id="cb201-3"><a href="coordinate-systems-in-r.html#cb201-3"></a>tissot.laea<span class="op">$</span>area_err &lt;-<span class="st"> </span><span class="kw">round</span>( (<span class="kw">st_area</span>(tissot.laea ) <span class="op">-</span><span class="st"> </span>tissot.laea<span class="op">$</span>geoArea) <span class="op">/</span><span class="st"> </span></span>
<span id="cb201-4"><a href="coordinate-systems-in-r.html#cb201-4"></a><span class="st">                                 </span>tissot.laea<span class="op">$</span>geoArea <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb201-5"><a href="coordinate-systems-in-r.html#cb201-5"></a></span>
<span id="cb201-6"><a href="coordinate-systems-in-r.html#cb201-6"></a><span class="co"># Plot the map</span></span>
<span id="cb201-7"><a href="coordinate-systems-in-r.html#cb201-7"></a><span class="kw">tm_shape</span>(World, <span class="dt">bbox =</span> <span class="kw">st_bbox</span>(tissot.laea), <span class="dt">projection =</span> <span class="kw">st_crs</span>(tissot.laea)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb201-8"><a href="coordinate-systems-in-r.html#cb201-8"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb201-9"><a href="coordinate-systems-in-r.html#cb201-9"></a><span class="st">  </span><span class="kw">tm_shape</span>(tissot.laea) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">border.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb201-10"><a href="coordinate-systems-in-r.html#cb201-10"></a><span class="st">  </span><span class="kw">tm_graticules</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">80</span>,<span class="op">-</span><span class="dv">100</span>, <span class="dv">-120</span>, <span class="dv">-140</span>), </span>
<span id="cb201-11"><a href="coordinate-systems-in-r.html#cb201-11"></a>           <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">45</span>, <span class="dv">60</span>),</span>
<span id="cb201-12"><a href="coordinate-systems-in-r.html#cb201-12"></a>           <span class="dt">labels.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">col=</span><span class="st">&quot;grey80&quot;</span>) <span class="op">+</span></span>
<span id="cb201-13"><a href="coordinate-systems-in-r.html#cb201-13"></a><span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;area_err&quot;</span>, <span class="dt">size=</span>.<span class="dv">8</span>, <span class="dt">alpha=</span><span class="fl">0.8</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-35-1.png" width="384" /></p>
<p>The area error across the 48 states is near 0. But note that the shape does become distorted as we move away from the center of projection.</p>
<p>Next, we’ll explore the Robinson projection.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="coordinate-systems-in-r.html#cb202-1"></a><span class="co"># Transform geodesic circles and compute area error as a percentage</span></span>
<span id="cb202-2"><a href="coordinate-systems-in-r.html#cb202-2"></a>tissot.robin &lt;-<span class="st"> </span><span class="kw">st_transform</span>(tissot.sf, <span class="st">&quot;+proj=robin  +ellps=WGS84&quot;</span>)</span>
<span id="cb202-3"><a href="coordinate-systems-in-r.html#cb202-3"></a>tissot.robin<span class="op">$</span>area_err &lt;-<span class="st"> </span><span class="kw">round</span>(  (<span class="kw">st_area</span>(tissot.robin ) <span class="op">-</span><span class="st"> </span>tissot.robin<span class="op">$</span>geoArea) <span class="op">/</span><span class="st"> </span></span>
<span id="cb202-4"><a href="coordinate-systems-in-r.html#cb202-4"></a><span class="st">                                   </span>tissot.robin<span class="op">$</span>geoArea <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb202-5"><a href="coordinate-systems-in-r.html#cb202-5"></a></span>
<span id="cb202-6"><a href="coordinate-systems-in-r.html#cb202-6"></a><span class="co"># Plot the map</span></span>
<span id="cb202-7"><a href="coordinate-systems-in-r.html#cb202-7"></a><span class="kw">tm_shape</span>(World, <span class="dt">bbox =</span> <span class="kw">st_bbox</span>(tissot.robin), <span class="dt">projection =</span> <span class="kw">st_crs</span>(tissot.robin)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb202-8"><a href="coordinate-systems-in-r.html#cb202-8"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb202-9"><a href="coordinate-systems-in-r.html#cb202-9"></a><span class="st">  </span><span class="kw">tm_shape</span>(tissot.robin) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">border.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb202-10"><a href="coordinate-systems-in-r.html#cb202-10"></a><span class="st">  </span><span class="kw">tm_graticules</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">80</span>,<span class="op">-</span><span class="dv">100</span>, <span class="dv">-120</span>, <span class="dv">-140</span>), </span>
<span id="cb202-11"><a href="coordinate-systems-in-r.html#cb202-11"></a>                <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">45</span>, <span class="dv">60</span>),</span>
<span id="cb202-12"><a href="coordinate-systems-in-r.html#cb202-12"></a>                <span class="dt">labels.col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">col=</span><span class="st">&quot;grey80&quot;</span>) <span class="op">+</span></span>
<span id="cb202-13"><a href="coordinate-systems-in-r.html#cb202-13"></a><span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;area_err&quot;</span>, <span class="dt">size=</span>.<span class="dv">8</span>, <span class="dt">alpha=</span><span class="fl">0.8</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="A06-Coordinate-Systems_files/figure-html/unnamed-chunk-36-1.png" width="384" /></p>
<p>Both shape and area are measurably distorted for the north american continent.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="raster-operations-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="point-pattern-analysis-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
