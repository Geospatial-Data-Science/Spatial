<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Interpolation in R | Intro to GIS and Spatial Analysis</title>
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Interpolation in R | Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Interpolation in R | Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-autocorrelation-in-r.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39623718-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-39623718-2');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a><ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>I Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="chp02-0.html"><a href="chp02-0.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a><ul>
<li class="chapter" data-level="2.1" data-path="chp02-0.html"><a href="chp02-0.html#vector-vs.-raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a><ul>
<li class="chapter" data-level="2.1.1" data-path="chp02-0.html"><a href="chp02-0.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="chp02-0.html"><a href="chp02-0.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chp02-0.html"><a href="chp02-0.html#object-vs.-field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chp02-0.html"><a href="chp02-0.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="chp02-0.html"><a href="chp02-0.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chp02-0.html"><a href="chp02-0.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="chp02-0.html"><a href="chp02-0.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chp02-0.html"><a href="chp02-0.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="chp02-0.html"><a href="chp02-0.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a><ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a><ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a><ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a><ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a><ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a><ul>
<li class="chapter" data-level="4.5.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#an-interactive-example"><i class="fa fa-check"></i><b>4.5.1</b> An Interactive Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>5</b> Pitfalls to avoid</a><ul>
<li class="chapter" data-level="5.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>5.1</b> Representing Count</a></li>
<li class="chapter" data-level="5.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>5.2</b> MAUP</a></li>
<li class="chapter" data-level="5.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>5.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="5.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>5.4</b> Mapping rates</a></li>
<li class="chapter" data-level="5.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>5.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>6</b> Good Map Making Tips</a><ul>
<li class="chapter" data-level="6.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>6.1</b> Elements of a map</a></li>
<li class="chapter" data-level="6.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>6.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="6.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>6.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html"><i class="fa fa-check"></i><b>7</b> Uncertainty in Census Data</a><ul>
<li class="chapter" data-level="7.1" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#mapping-uncertainty"><i class="fa fa-check"></i><b>7.2</b> Mapping uncertainty</a></li>
<li class="chapter" data-level="7.3" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="7.4" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#class-comparison-maps"><i class="fa fa-check"></i><b>7.4</b> Class comparison maps</a></li>
<li class="chapter" data-level="7.5" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>7.5</b> Problem when performing bivariate analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a><ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a><ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a><ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp09-0.html"><a href="chp09-0.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1" data-path="chp09-0.html"><a href="chp09-0.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1.1" data-path="chp09-0.html"><a href="chp09-0.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="chp09-0.html"><a href="chp09-0.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="chp09-0.html"><a href="chp09-0.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="chp09-0.html"><a href="chp09-0.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chp09-0.html"><a href="chp09-0.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chp09-0.html"><a href="chp09-0.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp09-0.html"><a href="chp09-0.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp09-0.html"><a href="chp09-0.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp09-0.html"><a href="chp09-0.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
<li class="chapter" data-level="9.4" data-path="chp09-0.html"><a href="chp09-0.html#geodesic-geometries"><i class="fa fa-check"></i><b>9.4</b> Geodesic geometries</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp10-0.html"><a href="chp10-0.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a><ul>
<li class="chapter" data-level="10.1" data-path="chp10-0.html"><a href="chp10-0.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="chp10-0.html"><a href="chp10-0.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="chp10-0.html"><a href="chp10-0.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="chp10-0.html"><a href="chp10-0.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="chp10-0.html"><a href="chp10-0.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a><ul>
<li class="chapter" data-level="10.5.1" data-path="chp10-0.html"><a href="chp10-0.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp10-0.html"><a href="chp10-0.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="chp10-0.html"><a href="chp10-0.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="chp10-0.html"><a href="chp10-0.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="chp11-0.html"><a href="chp11-0.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="chp11-0.html"><a href="chp11-0.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="chp11-0.html"><a href="chp11-0.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a><ul>
<li class="chapter" data-level="11.2.1" data-path="chp11-0.html"><a href="chp11-0.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="chp11-0.html"><a href="chp11-0.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="chp11-0.html"><a href="chp11-0.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chp11-0.html"><a href="chp11-0.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a><ul>
<li class="chapter" data-level="11.3.1" data-path="chp11-0.html"><a href="chp11-0.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="chp11-0.html"><a href="chp11-0.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="chp11-0.html"><a href="chp11-0.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chp11-0.html"><a href="chp11-0.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a><ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#PPM"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s I</a><ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s I</a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s I at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a><ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html"><i class="fa fa-check"></i>Reading and writing spatial data in R</a><ul>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4"><i class="fa fa-check"></i>Creating spatial objects</a><ul>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_1"><i class="fa fa-check"></i>Reading a shapefile</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_2"><i class="fa fa-check"></i>Reading a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_3"><i class="fa fa-check"></i>Reading a raster</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_5"><i class="fa fa-check"></i>Creating a spatial object from a data frame</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_4_6"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
</ul></li>
<li><a href="app1-1.html#app1_5">Converting from an <code>sf</code> object</a><ul>
<li><a href="app1-1.html#app1_5_1">Converting an <code>sf</code> object to a <code>Spatial*</code> object (<code>spdep</code>/<code>sp</code>)</a></li>
<li><a href="app1-1.html#app1_5_2">Converting an <code>sf</code> polygon object to an <code>owin</code> object</a></li>
<li><a href="app1-1.html#app1_5_3">Converting an <code>sf</code> point object to a <code>ppp</code> object</a></li>
<li><a href="app1-1.html#app1_5_4">Converting a <code>raster</code> object to an <code>im</code> object (<code>spatstat</code>)</a></li>
</ul></li>
<li><a href="app1-1.html#app1_6">Converting to an <code>sf</code> object</a></li>
<li><a href="app1-1.html#app1_7">Dissecting the <code>sf</code> file object</a></li>
<li class="chapter" data-level="" data-path="app1-1.html"><a href="app1-1.html#app1_8"><i class="fa fa-check"></i>Exporting to different data file formats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html"><i class="fa fa-check"></i>Mapping data in R</a><ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2"><i class="fa fa-check"></i>The basics</a><ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_1"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_2"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_3"><i class="fa fa-check"></i>Tweaking colors</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_4"><i class="fa fa-check"></i>Adding labels</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_2_5"><i class="fa fa-check"></i>Adding a grid or graticule</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_3"><i class="fa fa-check"></i>Adding statistical plots</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_4"><i class="fa fa-check"></i>Mapping raster files</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_5"><i class="fa fa-check"></i>Changing coordinate systems</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_6"><i class="fa fa-check"></i>Side-by-side maps</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#app2_7"><i class="fa fa-check"></i>Splitting data by polygons or group of polygons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i>Mapping rates in R</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_1"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_2"><i class="fa fa-check"></i>Standardized mortality ratios (relative risk).</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_3"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_4"><i class="fa fa-check"></i>Unstable ratios</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_4_1"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#app3_4_2"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i>Vector operations in R</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_1"><i class="fa fa-check"></i>Dissolve by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_2"><i class="fa fa-check"></i>Dissolve by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_3"><i class="fa fa-check"></i>Calculate area</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_4"><i class="fa fa-check"></i>Subsetting</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_5"><i class="fa fa-check"></i>Intersecting</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-polygons-with-line-and-point-objects"><i class="fa fa-check"></i>Intersecting polygons with line and point objects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#app4_6"><i class="fa fa-check"></i>Unioning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i>Raster operations in R</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_2"><i class="fa fa-check"></i>Local operations and functions</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_2_1"><i class="fa fa-check"></i>Unary operations and functions (applied to single rasters)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_2_2"><i class="fa fa-check"></i>Binary operations and functions (where two rasters are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_5"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_6"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_7"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_8"><i class="fa fa-check"></i>Computing cumulative distances</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#app5_8_1"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i>Coordinate Systems in R</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#sample-files-for-this-exercise"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-proj4-coordinate-syntax"><i class="fa fa-check"></i>Understanding the Proj4 coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#transforming-coordinate-systems"><i class="fa fa-check"></i>Transforming coordinate systems</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#example-of-a-failed-transformation"><i class="fa fa-check"></i>Example of a failed transformation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-containment"><i class="fa fa-check"></i>A note about containment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#creating-tissot-indicatrix-circles"><i class="fa fa-check"></i>Creating Tissot indicatrix circles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i>Point pattern analysis in R</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li><a href="point-pattern-analysis-in-r.html#pppR2">Getting external data into a <code>spatstat</code> format</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR3"><i class="fa fa-check"></i>Prepping the data</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR4"><i class="fa fa-check"></i>Density based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR5"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR6"><i class="fa fa-check"></i>Quadrat density on a tessellated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR7"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR8"><i class="fa fa-check"></i>Kernel density adjusted for covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR9"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR10"><i class="fa fa-check"></i>Distance based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR11"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR12"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR13"><i class="fa fa-check"></i>Pair correlation function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR14"><i class="fa fa-check"></i>Hypothesis tests</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR15"><i class="fa fa-check"></i>Test for clustering/dispersion</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR16"><i class="fa fa-check"></i>Computing a pseudo p-value from the simulation</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pppR17"><i class="fa fa-check"></i>Test for a poisson point process model with a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i>Spatial autocorrelation in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_3"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_4"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the hard way</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-a-pseudo-p-value-from-an-mc-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from an MC simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_5"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the easy way</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_6"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i>Interpolation in R</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li><a href="interpolation-in-r.html#st-order-polynomial-fit">1<sup>st</sup> order polynomial fit</a></li>
<li><a href="interpolation-in-r.html#nd-order-polynomial">2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps"><i class="fa fa-check"></i>Generate the variance and confidence interval maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interpolation-in-r" class="section level1 unnumbered">
<h1>Interpolation in R</h1>
<table class="package_ver_table">
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
R
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
gstat
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
raster
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
maptools
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
spatstat
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
spatstat.data
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
tmap
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
rgdal
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sp
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
4.0.1
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
2.0.6
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.4.5
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.0.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.64.1
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.7.0
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.5.18
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.4.4
</td>
</tr>
</tbody>
</table>
<p>First, let’s load the data from the website. The data are stored as <code>SpatialPointsDataFrame</code> and <code>SpatialPointsDataFrame</code> objects. Most of the functions used in this exercise work off of these classes. The one exception is the <code>direchlet</code> function which requires a conversion to a <code>ppp</code> object.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="interpolation-in-r.html#cb293-1"></a><span class="kw">library</span>(rgdal)</span>
<span id="cb293-2"><a href="interpolation-in-r.html#cb293-2"></a><span class="kw">library</span>(tmap)</span>
<span id="cb293-3"><a href="interpolation-in-r.html#cb293-3"></a></span>
<span id="cb293-4"><a href="interpolation-in-r.html#cb293-4"></a><span class="co"># Load precipitation data</span></span>
<span id="cb293-5"><a href="interpolation-in-r.html#cb293-5"></a>z &lt;-<span class="st"> </span><span class="kw">gzcon</span>(<span class="kw">url</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/precip.rds&quot;</span>))</span>
<span id="cb293-6"><a href="interpolation-in-r.html#cb293-6"></a>P &lt;-<span class="st"> </span><span class="kw">readRDS</span>(z)</span>
<span id="cb293-7"><a href="interpolation-in-r.html#cb293-7"></a></span>
<span id="cb293-8"><a href="interpolation-in-r.html#cb293-8"></a><span class="co"># Load Texas boudary map</span></span>
<span id="cb293-9"><a href="interpolation-in-r.html#cb293-9"></a>z &lt;-<span class="st"> </span><span class="kw">gzcon</span>(<span class="kw">url</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/texas.rds&quot;</span>))</span>
<span id="cb293-10"><a href="interpolation-in-r.html#cb293-10"></a>W &lt;-<span class="st"> </span><span class="kw">readRDS</span>(z)</span>
<span id="cb293-11"><a href="interpolation-in-r.html#cb293-11"></a></span>
<span id="cb293-12"><a href="interpolation-in-r.html#cb293-12"></a><span class="co"># Replace point boundary extent with that of Texas</span></span>
<span id="cb293-13"><a href="interpolation-in-r.html#cb293-13"></a>P<span class="op">@</span>bbox &lt;-<span class="st"> </span>W<span class="op">@</span>bbox</span>
<span id="cb293-14"><a href="interpolation-in-r.html#cb293-14"></a></span>
<span id="cb293-15"><a href="interpolation-in-r.html#cb293-15"></a><span class="kw">tm_shape</span>(W) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>() <span class="op">+</span></span>
<span id="cb293-16"><a href="interpolation-in-r.html#cb293-16"></a><span class="st">  </span><span class="kw">tm_shape</span>(P) <span class="op">+</span></span>
<span id="cb293-17"><a href="interpolation-in-r.html#cb293-17"></a><span class="st">  </span><span class="kw">tm_dots</span>(<span class="dt">col=</span><span class="st">&quot;Precip_in&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">auto.palette.mapping =</span> <span class="ot">FALSE</span>,</span>
<span id="cb293-18"><a href="interpolation-in-r.html#cb293-18"></a>             <span class="dt">title=</span><span class="st">&quot;Sampled precipitation </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>, <span class="dt">size=</span><span class="fl">0.7</span>) <span class="op">+</span></span>
<span id="cb293-19"><a href="interpolation-in-r.html#cb293-19"></a><span class="st">  </span><span class="kw">tm_text</span>(<span class="st">&quot;Precip_in&quot;</span>, <span class="dt">just=</span><span class="st">&quot;left&quot;</span>, <span class="dt">xmod=</span>.<span class="dv">5</span>, <span class="dt">size =</span> <span class="fl">0.7</span>) <span class="op">+</span></span>
<span id="cb293-20"><a href="interpolation-in-r.html#cb293-20"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>You’ll note the line <code>P@bbox &lt;- W@bbox</code> which forces the rectangular extent of the Texas map onto the point data object. This is an important step if the interpolation of the points are to cover the entire extent of Texas. Had this step been omitted, most of the interpolated layers would have been limited to the smallest rectangular extent enclosing the point object.</p>
<div id="thiessen-polygons" class="section level2 unnumbered">
<h2>Thiessen polygons</h2>
<p>The Thiessen polygons (or proximity interpolation) can be created using <code>spatstat</code>’s <code>dirichlet</code> function.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="interpolation-in-r.html#cb294-1"></a><span class="kw">library</span>(spatstat)  <span class="co"># Used for the dirichlet tessellation function</span></span>
<span id="cb294-2"><a href="interpolation-in-r.html#cb294-2"></a><span class="kw">library</span>(maptools)  <span class="co"># Used for conversion from SPDF to ppp</span></span>
<span id="cb294-3"><a href="interpolation-in-r.html#cb294-3"></a><span class="kw">library</span>(raster)    <span class="co"># Used to clip out thiessen polygons</span></span>
<span id="cb294-4"><a href="interpolation-in-r.html#cb294-4"></a></span>
<span id="cb294-5"><a href="interpolation-in-r.html#cb294-5"></a><span class="co"># Create a tessellated surface</span></span>
<span id="cb294-6"><a href="interpolation-in-r.html#cb294-6"></a>th  &lt;-<span class="st">  </span><span class="kw">as</span>(<span class="kw">dirichlet</span>(<span class="kw">as.ppp</span>(P)), <span class="st">&quot;SpatialPolygons&quot;</span>)</span>
<span id="cb294-7"><a href="interpolation-in-r.html#cb294-7"></a></span>
<span id="cb294-8"><a href="interpolation-in-r.html#cb294-8"></a><span class="co"># The dirichlet function does not carry over projection information</span></span>
<span id="cb294-9"><a href="interpolation-in-r.html#cb294-9"></a><span class="co"># requiring that this information be added manually</span></span>
<span id="cb294-10"><a href="interpolation-in-r.html#cb294-10"></a><span class="kw">proj4string</span>(th) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(P)</span>
<span id="cb294-11"><a href="interpolation-in-r.html#cb294-11"></a></span>
<span id="cb294-12"><a href="interpolation-in-r.html#cb294-12"></a><span class="co"># The tessellated surface does not store attribute information</span></span>
<span id="cb294-13"><a href="interpolation-in-r.html#cb294-13"></a><span class="co"># from the point data layer. We&#39;ll use the over() function (from the sp</span></span>
<span id="cb294-14"><a href="interpolation-in-r.html#cb294-14"></a><span class="co"># package) to join the point attributes to the tesselated surface via</span></span>
<span id="cb294-15"><a href="interpolation-in-r.html#cb294-15"></a><span class="co"># a spatial join. The over() function creates a dataframe that will need to</span></span>
<span id="cb294-16"><a href="interpolation-in-r.html#cb294-16"></a><span class="co"># be added to the `th` object thus creating a SpatialPolygonsDataFrame object</span></span>
<span id="cb294-17"><a href="interpolation-in-r.html#cb294-17"></a>th.z     &lt;-<span class="st"> </span><span class="kw">over</span>(th, P, <span class="dt">fn=</span>mean)</span>
<span id="cb294-18"><a href="interpolation-in-r.html#cb294-18"></a>th.spdf  &lt;-<span class="st">  </span><span class="kw">SpatialPolygonsDataFrame</span>(th, th.z)</span>
<span id="cb294-19"><a href="interpolation-in-r.html#cb294-19"></a></span>
<span id="cb294-20"><a href="interpolation-in-r.html#cb294-20"></a><span class="co"># Finally, we&#39;ll clip the tessellated  surface to the Texas boundaries</span></span>
<span id="cb294-21"><a href="interpolation-in-r.html#cb294-21"></a>th.clp   &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">intersect</span>(W,th.spdf)</span>
<span id="cb294-22"><a href="interpolation-in-r.html#cb294-22"></a></span>
<span id="cb294-23"><a href="interpolation-in-r.html#cb294-23"></a><span class="co"># Map the data</span></span>
<span id="cb294-24"><a href="interpolation-in-r.html#cb294-24"></a><span class="kw">tm_shape</span>(th.clp) <span class="op">+</span><span class="st"> </span></span>
<span id="cb294-25"><a href="interpolation-in-r.html#cb294-25"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col=</span><span class="st">&quot;Precip_in&quot;</span>, <span class="dt">palette=</span><span class="st">&quot;RdBu&quot;</span>, <span class="dt">auto.palette.mapping=</span><span class="ot">FALSE</span>,</span>
<span id="cb294-26"><a href="interpolation-in-r.html#cb294-26"></a>              <span class="dt">title=</span><span class="st">&quot;Predicted precipitation </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span></span>
<span id="cb294-27"><a href="interpolation-in-r.html#cb294-27"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="warning">
<p>
Many packages share the same function names. This can be a problem when these packages are loaded in a same R session. For example, the <code>intersect</code> function is available in the <code>base</code>, <code>spatstat</code> and <code>raster</code> packages–all of which are loaded in this current session. To ensure that the proper function is selected, it’s a good idea to preface the function name with the package name as in <code>raster::intersect()</code>.
</p>
<p>
This tip will be used in the next chunk of code when calling the <code>idw</code> function which is available in both <code>spatstat</code> and <code>gstat</code>.
</p>
</div>
<p>Note that the <code>dirichlet</code> function (like most functions in the <code>spatsat</code> package) require that the point object be in a <code>ppp</code> format hence the inline <code>as.ppp(P)</code> syntax.</p>
</div>
<div id="idw" class="section level2 unnumbered">
<h2>IDW</h2>
<p>The IDW output is a raster. This requires that we first create an empty raster grid, then interpolate the precipitation values to each unsampled grid cell. An IDW power value of 2 (<code>idp=2.0</code>) will be used.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="interpolation-in-r.html#cb295-1"></a><span class="kw">library</span>(gstat) <span class="co"># Use gstat&#39;s idw routine</span></span>
<span id="cb295-2"><a href="interpolation-in-r.html#cb295-2"></a><span class="kw">library</span>(sp)    <span class="co"># Used for the spsample function</span></span>
<span id="cb295-3"><a href="interpolation-in-r.html#cb295-3"></a></span>
<span id="cb295-4"><a href="interpolation-in-r.html#cb295-4"></a><span class="co"># Create an empty grid where n is the total number of cells</span></span>
<span id="cb295-5"><a href="interpolation-in-r.html#cb295-5"></a>grd              &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">spsample</span>(P, <span class="st">&quot;regular&quot;</span>, <span class="dt">n=</span><span class="dv">50000</span>))</span>
<span id="cb295-6"><a href="interpolation-in-r.html#cb295-6"></a><span class="kw">names</span>(grd)       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb295-7"><a href="interpolation-in-r.html#cb295-7"></a><span class="kw">coordinates</span>(grd) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb295-8"><a href="interpolation-in-r.html#cb295-8"></a><span class="kw">gridded</span>(grd)     &lt;-<span class="st"> </span><span class="ot">TRUE</span>  <span class="co"># Create SpatialPixel object</span></span>
<span id="cb295-9"><a href="interpolation-in-r.html#cb295-9"></a><span class="kw">fullgrid</span>(grd)    &lt;-<span class="st"> </span><span class="ot">TRUE</span>  <span class="co"># Create SpatialGrid object</span></span>
<span id="cb295-10"><a href="interpolation-in-r.html#cb295-10"></a></span>
<span id="cb295-11"><a href="interpolation-in-r.html#cb295-11"></a><span class="co"># Add P&#39;s projection information to the empty grid</span></span>
<span id="cb295-12"><a href="interpolation-in-r.html#cb295-12"></a><span class="kw">proj4string</span>(P) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(P) <span class="co"># Temp fix until new proj env is adopted</span></span>
<span id="cb295-13"><a href="interpolation-in-r.html#cb295-13"></a><span class="kw">proj4string</span>(grd) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(P)</span>
<span id="cb295-14"><a href="interpolation-in-r.html#cb295-14"></a></span>
<span id="cb295-15"><a href="interpolation-in-r.html#cb295-15"></a><span class="co"># Interpolate the grid cells using a power value of 2 (idp=2.0)</span></span>
<span id="cb295-16"><a href="interpolation-in-r.html#cb295-16"></a>P.idw &lt;-<span class="st"> </span>gstat<span class="op">::</span><span class="kw">idw</span>(Precip_in <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, P, <span class="dt">newdata=</span>grd, <span class="dt">idp=</span><span class="fl">2.0</span>)</span>
<span id="cb295-17"><a href="interpolation-in-r.html#cb295-17"></a></span>
<span id="cb295-18"><a href="interpolation-in-r.html#cb295-18"></a><span class="co"># Convert to raster object then clip to Texas</span></span>
<span id="cb295-19"><a href="interpolation-in-r.html#cb295-19"></a>r       &lt;-<span class="st"> </span><span class="kw">raster</span>(P.idw)</span>
<span id="cb295-20"><a href="interpolation-in-r.html#cb295-20"></a>r.m     &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb295-21"><a href="interpolation-in-r.html#cb295-21"></a></span>
<span id="cb295-22"><a href="interpolation-in-r.html#cb295-22"></a><span class="co"># Plot</span></span>
<span id="cb295-23"><a href="interpolation-in-r.html#cb295-23"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span></span>
<span id="cb295-24"><a href="interpolation-in-r.html#cb295-24"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">10</span>,<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">auto.palette.mapping =</span> <span class="ot">FALSE</span>,</span>
<span id="cb295-25"><a href="interpolation-in-r.html#cb295-25"></a>            <span class="dt">title=</span><span class="st">&quot;Predicted precipitation </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb295-26"><a href="interpolation-in-r.html#cb295-26"></a><span class="st">  </span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb295-27"><a href="interpolation-in-r.html#cb295-27"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="fine-tuning-the-interpolation" class="section level3 unnumbered">
<h3>Fine-tuning the interpolation</h3>
<p>The choice of power function can be subjective. To fine-tune the choice of the power parameter, you can perform a <em>leave-one-out</em> validation routine to measure the error in the interpolated values.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="interpolation-in-r.html#cb296-1"></a><span class="co"># Leave-one-out validation routine</span></span>
<span id="cb296-2"><a href="interpolation-in-r.html#cb296-2"></a>IDW.out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> <span class="kw">length</span>(P))</span>
<span id="cb296-3"><a href="interpolation-in-r.html#cb296-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(P)) {</span>
<span id="cb296-4"><a href="interpolation-in-r.html#cb296-4"></a>  IDW.out[i] &lt;-<span class="st"> </span><span class="kw">idw</span>(Precip_in <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, P[<span class="op">-</span>i,], P[i,], <span class="dt">idp=</span><span class="fl">2.0</span>)<span class="op">$</span>var1.pred</span>
<span id="cb296-5"><a href="interpolation-in-r.html#cb296-5"></a>}</span>
<span id="cb296-6"><a href="interpolation-in-r.html#cb296-6"></a></span>
<span id="cb296-7"><a href="interpolation-in-r.html#cb296-7"></a><span class="co"># Plot the differences</span></span>
<span id="cb296-8"><a href="interpolation-in-r.html#cb296-8"></a>OP &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">pty=</span><span class="st">&quot;s&quot;</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb296-9"><a href="interpolation-in-r.html#cb296-9"></a>  <span class="kw">plot</span>(IDW.out <span class="op">~</span><span class="st"> </span>P<span class="op">$</span>Precip_in, <span class="dt">asp=</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;Observed&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Predicted&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>,</span>
<span id="cb296-10"><a href="interpolation-in-r.html#cb296-10"></a>       <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb296-11"><a href="interpolation-in-r.html#cb296-11"></a>  <span class="kw">abline</span>(<span class="kw">lm</span>(IDW.out <span class="op">~</span><span class="st"> </span>P<span class="op">$</span>Precip_in), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lw=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb296-12"><a href="interpolation-in-r.html#cb296-12"></a>  <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb296-13"><a href="interpolation-in-r.html#cb296-13"></a><span class="kw">par</span>(OP)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The RMSE can be computed from <code>IDW.out</code> as follows:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="interpolation-in-r.html#cb297-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb297-2"><a href="interpolation-in-r.html#cb297-2"></a><span class="kw">sqrt</span>( <span class="kw">sum</span>((IDW.out <span class="op">-</span><span class="st"> </span>P<span class="op">$</span>Precip_in)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(P))</span></code></pre></div>
<pre><code>[1] 6.989294</code></pre>
</div>
<div id="cross-validation" class="section level3 unnumbered">
<h3>Cross-validation</h3>
<p>In addition to generating an interpolated surface, you can create a 95% confidence interval map of the interpolation model. Here we’ll create a 95% CI map from an IDW interpolation that uses a power parameter of 2 (<code>idp=2.0</code>).</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="interpolation-in-r.html#cb299-1"></a><span class="co"># Implementation of a jackknife technique to estimate </span></span>
<span id="cb299-2"><a href="interpolation-in-r.html#cb299-2"></a><span class="co"># a confidence interval at each unsampled point.</span></span>
<span id="cb299-3"><a href="interpolation-in-r.html#cb299-3"></a></span>
<span id="cb299-4"><a href="interpolation-in-r.html#cb299-4"></a><span class="co"># Create the interpolated surface</span></span>
<span id="cb299-5"><a href="interpolation-in-r.html#cb299-5"></a>img &lt;-<span class="st"> </span>gstat<span class="op">::</span><span class="kw">idw</span>(Precip_in<span class="op">~</span><span class="dv">1</span>, P, <span class="dt">newdata=</span>grd, <span class="dt">idp=</span><span class="fl">2.0</span>)</span>
<span id="cb299-6"><a href="interpolation-in-r.html#cb299-6"></a>n   &lt;-<span class="st"> </span><span class="kw">length</span>(P)</span>
<span id="cb299-7"><a href="interpolation-in-r.html#cb299-7"></a>Zi  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="kw">length</span>(img<span class="op">$</span>var1.pred), <span class="dt">ncol =</span> n)</span>
<span id="cb299-8"><a href="interpolation-in-r.html#cb299-8"></a></span>
<span id="cb299-9"><a href="interpolation-in-r.html#cb299-9"></a><span class="co"># Remove a point then interpolate (do this n times for each point)</span></span>
<span id="cb299-10"><a href="interpolation-in-r.html#cb299-10"></a>st &lt;-<span class="st"> </span><span class="kw">stack</span>()</span>
<span id="cb299-11"><a href="interpolation-in-r.html#cb299-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb299-12"><a href="interpolation-in-r.html#cb299-12"></a>  Z1 &lt;-<span class="st"> </span>gstat<span class="op">::</span><span class="kw">idw</span>(Precip_in<span class="op">~</span><span class="dv">1</span>, P[<span class="op">-</span>i,], <span class="dt">newdata=</span>grd, <span class="dt">idp=</span><span class="fl">2.0</span>)</span>
<span id="cb299-13"><a href="interpolation-in-r.html#cb299-13"></a>  st &lt;-<span class="st"> </span><span class="kw">addLayer</span>(st,<span class="kw">raster</span>(Z1,<span class="dt">layer=</span><span class="dv">1</span>))</span>
<span id="cb299-14"><a href="interpolation-in-r.html#cb299-14"></a>  <span class="co"># Calculated pseudo-value Z at j</span></span>
<span id="cb299-15"><a href="interpolation-in-r.html#cb299-15"></a>  Zi[,i] &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>img<span class="op">$</span>var1.pred <span class="op">-</span><span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span>Z1<span class="op">$</span>var1.pred</span>
<span id="cb299-16"><a href="interpolation-in-r.html#cb299-16"></a>}</span>
<span id="cb299-17"><a href="interpolation-in-r.html#cb299-17"></a></span>
<span id="cb299-18"><a href="interpolation-in-r.html#cb299-18"></a><span class="co"># Jackknife estimator of parameter Z at location j</span></span>
<span id="cb299-19"><a href="interpolation-in-r.html#cb299-19"></a>Zj &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(Zi, <span class="dv">1</span>, sum, <span class="dt">na.rm=</span>T) <span class="op">/</span><span class="st"> </span>n )</span>
<span id="cb299-20"><a href="interpolation-in-r.html#cb299-20"></a></span>
<span id="cb299-21"><a href="interpolation-in-r.html#cb299-21"></a><span class="co"># Compute (Zi* - Zj)^2</span></span>
<span id="cb299-22"><a href="interpolation-in-r.html#cb299-22"></a>c1 &lt;-<span class="st"> </span><span class="kw">apply</span>(Zi,<span class="dv">2</span>,<span class="st">&#39;-&#39;</span>,Zj)            <span class="co"># Compute the difference</span></span>
<span id="cb299-23"><a href="interpolation-in-r.html#cb299-23"></a>c1 &lt;-<span class="st"> </span><span class="kw">apply</span>(c1<span class="op">^</span><span class="dv">2</span>, <span class="dv">1</span>, sum, <span class="dt">na.rm=</span>T ) <span class="co"># Sum the square of the difference</span></span>
<span id="cb299-24"><a href="interpolation-in-r.html#cb299-24"></a></span>
<span id="cb299-25"><a href="interpolation-in-r.html#cb299-25"></a><span class="co"># Compute the confidence interval</span></span>
<span id="cb299-26"><a href="interpolation-in-r.html#cb299-26"></a>CI &lt;-<span class="st"> </span><span class="kw">sqrt</span>( <span class="dv">1</span><span class="op">/</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>c1)</span>
<span id="cb299-27"><a href="interpolation-in-r.html#cb299-27"></a></span>
<span id="cb299-28"><a href="interpolation-in-r.html#cb299-28"></a><span class="co"># Create (CI / interpolated value) raster</span></span>
<span id="cb299-29"><a href="interpolation-in-r.html#cb299-29"></a>img.sig   &lt;-<span class="st"> </span>img</span>
<span id="cb299-30"><a href="interpolation-in-r.html#cb299-30"></a>img.sig<span class="op">$</span>v &lt;-<span class="st"> </span>CI <span class="op">/</span>img<span class="op">$</span>var1.pred </span>
<span id="cb299-31"><a href="interpolation-in-r.html#cb299-31"></a></span>
<span id="cb299-32"><a href="interpolation-in-r.html#cb299-32"></a><span class="co"># Clip the confidence raster to Texas</span></span>
<span id="cb299-33"><a href="interpolation-in-r.html#cb299-33"></a>r &lt;-<span class="st"> </span><span class="kw">raster</span>(img.sig, <span class="dt">layer=</span><span class="st">&quot;v&quot;</span>)</span>
<span id="cb299-34"><a href="interpolation-in-r.html#cb299-34"></a>r.m &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb299-35"><a href="interpolation-in-r.html#cb299-35"></a></span>
<span id="cb299-36"><a href="interpolation-in-r.html#cb299-36"></a><span class="co"># Plot the map</span></span>
<span id="cb299-37"><a href="interpolation-in-r.html#cb299-37"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">7</span>,<span class="dt">title=</span><span class="st">&quot;95% confidence interval </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span></span>
<span id="cb299-38"><a href="interpolation-in-r.html#cb299-38"></a><span class="st">  </span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb299-39"><a href="interpolation-in-r.html#cb299-39"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="st-order-polynomial-fit" class="section level2 unnumbered">
<h2>1<sup>st</sup> order polynomial fit</h2>
<p>To fit a first order polynomial model of the form <span class="math inline">\(precip = intercept + aX + bY\)</span> to the data,</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="interpolation-in-r.html#cb300-1"></a><span class="co"># Define the 1st order polynomial equation</span></span>
<span id="cb300-2"><a href="interpolation-in-r.html#cb300-2"></a>f<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">as.formula</span>(Precip_in <span class="op">~</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span>Y) </span>
<span id="cb300-3"><a href="interpolation-in-r.html#cb300-3"></a> </span>
<span id="cb300-4"><a href="interpolation-in-r.html#cb300-4"></a><span class="co"># Add X and Y to P</span></span>
<span id="cb300-5"><a href="interpolation-in-r.html#cb300-5"></a>P<span class="op">$</span>X &lt;-<span class="st"> </span><span class="kw">coordinates</span>(P)[,<span class="dv">1</span>]</span>
<span id="cb300-6"><a href="interpolation-in-r.html#cb300-6"></a>P<span class="op">$</span>Y &lt;-<span class="st"> </span><span class="kw">coordinates</span>(P)[,<span class="dv">2</span>]</span>
<span id="cb300-7"><a href="interpolation-in-r.html#cb300-7"></a></span>
<span id="cb300-8"><a href="interpolation-in-r.html#cb300-8"></a><span class="co"># Run the regression model</span></span>
<span id="cb300-9"><a href="interpolation-in-r.html#cb300-9"></a>lm<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( f<span class="fl">.1</span>, <span class="dt">data=</span>P)</span>
<span id="cb300-10"><a href="interpolation-in-r.html#cb300-10"></a></span>
<span id="cb300-11"><a href="interpolation-in-r.html#cb300-11"></a><span class="co"># Use the regression model output to interpolate the surface</span></span>
<span id="cb300-12"><a href="interpolation-in-r.html#cb300-12"></a>dat<span class="fl">.1</span>st &lt;-<span class="st"> </span><span class="kw">SpatialGridDataFrame</span>(grd, <span class="kw">data.frame</span>(<span class="dt">var1.pred =</span> <span class="kw">predict</span>(lm<span class="fl">.1</span>, <span class="dt">newdata=</span>grd))) </span>
<span id="cb300-13"><a href="interpolation-in-r.html#cb300-13"></a></span>
<span id="cb300-14"><a href="interpolation-in-r.html#cb300-14"></a><span class="co"># Clip the interpolated raster to Texas</span></span>
<span id="cb300-15"><a href="interpolation-in-r.html#cb300-15"></a>r   &lt;-<span class="st"> </span><span class="kw">raster</span>(dat<span class="fl">.1</span>st)</span>
<span id="cb300-16"><a href="interpolation-in-r.html#cb300-16"></a>r.m &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb300-17"><a href="interpolation-in-r.html#cb300-17"></a></span>
<span id="cb300-18"><a href="interpolation-in-r.html#cb300-18"></a><span class="co"># Plot the map</span></span>
<span id="cb300-19"><a href="interpolation-in-r.html#cb300-19"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span></span>
<span id="cb300-20"><a href="interpolation-in-r.html#cb300-20"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">palette=</span><span class="st">&quot;RdBu&quot;</span>, <span class="dt">auto.palette.mapping=</span><span class="ot">FALSE</span>, </span>
<span id="cb300-21"><a href="interpolation-in-r.html#cb300-21"></a>            <span class="dt">title=</span><span class="st">&quot;Predicted precipitation </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span></span>
<span id="cb300-22"><a href="interpolation-in-r.html#cb300-22"></a><span class="st">  </span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb300-23"><a href="interpolation-in-r.html#cb300-23"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="nd-order-polynomial" class="section level2 unnumbered">
<h2>2<sup>nd</sup> order polynomial</h2>
<p>To fit a second order polynomial model of the form <span class="math inline">\(precip = intercept + aX + bY + dX^2 + eY^2 +fXY\)</span> to the data,</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="interpolation-in-r.html#cb301-1"></a><span class="co"># Define the 2nd order polynomial equation</span></span>
<span id="cb301-2"><a href="interpolation-in-r.html#cb301-2"></a>f<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">as.formula</span>(Precip_in <span class="op">~</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span>Y <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(X<span class="op">*</span>X)<span class="op">+</span><span class="kw">I</span>(Y<span class="op">*</span>Y) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(X<span class="op">*</span>Y))</span>
<span id="cb301-3"><a href="interpolation-in-r.html#cb301-3"></a></span>
<span id="cb301-4"><a href="interpolation-in-r.html#cb301-4"></a><span class="co"># Add X and Y to P</span></span>
<span id="cb301-5"><a href="interpolation-in-r.html#cb301-5"></a>P<span class="op">$</span>X &lt;-<span class="st"> </span><span class="kw">coordinates</span>(P)[,<span class="dv">1</span>]</span>
<span id="cb301-6"><a href="interpolation-in-r.html#cb301-6"></a>P<span class="op">$</span>Y &lt;-<span class="st"> </span><span class="kw">coordinates</span>(P)[,<span class="dv">2</span>]</span>
<span id="cb301-7"><a href="interpolation-in-r.html#cb301-7"></a> </span>
<span id="cb301-8"><a href="interpolation-in-r.html#cb301-8"></a><span class="co"># Run the regression model</span></span>
<span id="cb301-9"><a href="interpolation-in-r.html#cb301-9"></a>lm<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>( f<span class="fl">.2</span>, <span class="dt">data=</span>P)</span>
<span id="cb301-10"><a href="interpolation-in-r.html#cb301-10"></a></span>
<span id="cb301-11"><a href="interpolation-in-r.html#cb301-11"></a><span class="co"># Use the regression model output to interpolate the surface</span></span>
<span id="cb301-12"><a href="interpolation-in-r.html#cb301-12"></a>dat<span class="fl">.2</span>nd &lt;-<span class="st"> </span><span class="kw">SpatialGridDataFrame</span>(grd, <span class="kw">data.frame</span>(<span class="dt">var1.pred =</span> <span class="kw">predict</span>(lm<span class="fl">.2</span>, <span class="dt">newdata=</span>grd))) </span>
<span id="cb301-13"><a href="interpolation-in-r.html#cb301-13"></a></span>
<span id="cb301-14"><a href="interpolation-in-r.html#cb301-14"></a><span class="co"># Clip the interpolated raster to Texas</span></span>
<span id="cb301-15"><a href="interpolation-in-r.html#cb301-15"></a>r   &lt;-<span class="st"> </span><span class="kw">raster</span>(dat<span class="fl">.2</span>nd)</span>
<span id="cb301-16"><a href="interpolation-in-r.html#cb301-16"></a>r.m &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb301-17"><a href="interpolation-in-r.html#cb301-17"></a></span>
<span id="cb301-18"><a href="interpolation-in-r.html#cb301-18"></a><span class="co"># Plot the map</span></span>
<span id="cb301-19"><a href="interpolation-in-r.html#cb301-19"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span></span>
<span id="cb301-20"><a href="interpolation-in-r.html#cb301-20"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">palette=</span><span class="st">&quot;RdBu&quot;</span>, <span class="dt">auto.palette.mapping=</span><span class="ot">FALSE</span>,</span>
<span id="cb301-21"><a href="interpolation-in-r.html#cb301-21"></a>            <span class="dt">title=</span><span class="st">&quot;Predicted precipitation </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span></span>
<span id="cb301-22"><a href="interpolation-in-r.html#cb301-22"></a><span class="st">  </span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb301-23"><a href="interpolation-in-r.html#cb301-23"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="kriging" class="section level2 unnumbered">
<h2>Kriging</h2>
<div id="fit-the-variogram-model" class="section level3 unnumbered">
<h3>Fit the variogram model</h3>
<p>First, we need to create a variogram model. Note that the variogram model is computed on the <strong>de-trended</strong> data. This is implemented in the following chunk of code by passing the 1<sup>st</sup> order trend model (defined in an earlier code chunk as formula object <code>f.1</code>) to the <code>variogram</code> function.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="interpolation-in-r.html#cb302-1"></a><span class="co"># Define the 1st order polynomial equation</span></span>
<span id="cb302-2"><a href="interpolation-in-r.html#cb302-2"></a>f<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">as.formula</span>(Precip_in <span class="op">~</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span>Y) </span>
<span id="cb302-3"><a href="interpolation-in-r.html#cb302-3"></a></span>
<span id="cb302-4"><a href="interpolation-in-r.html#cb302-4"></a><span class="co"># Compute the sample variogram; note that the f.1 trend model is one of the</span></span>
<span id="cb302-5"><a href="interpolation-in-r.html#cb302-5"></a><span class="co"># parameters passed to variogram(). This tells the function to create the </span></span>
<span id="cb302-6"><a href="interpolation-in-r.html#cb302-6"></a><span class="co"># variogram on the de-trended data.</span></span>
<span id="cb302-7"><a href="interpolation-in-r.html#cb302-7"></a>var.smpl &lt;-<span class="st"> </span><span class="kw">variogram</span>(f<span class="fl">.1</span>, P, <span class="dt">cloud =</span> <span class="ot">FALSE</span>, <span class="dt">cutoff=</span><span class="dv">1000000</span>, <span class="dt">width=</span><span class="dv">89900</span>)</span>
<span id="cb302-8"><a href="interpolation-in-r.html#cb302-8"></a></span>
<span id="cb302-9"><a href="interpolation-in-r.html#cb302-9"></a><span class="co"># Compute the variogram model by passing the nugget, sill and range values</span></span>
<span id="cb302-10"><a href="interpolation-in-r.html#cb302-10"></a><span class="co"># to fit.variogram() via the vgm() function.</span></span>
<span id="cb302-11"><a href="interpolation-in-r.html#cb302-11"></a>dat.fit  &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(var.smpl, <span class="dt">fit.ranges =</span> <span class="ot">FALSE</span>, <span class="dt">fit.sills =</span> <span class="ot">FALSE</span>,</span>
<span id="cb302-12"><a href="interpolation-in-r.html#cb302-12"></a>                          <span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">14</span>, <span class="dt">model=</span><span class="st">&quot;Sph&quot;</span>, <span class="dt">range=</span><span class="dv">590000</span>, <span class="dt">nugget=</span><span class="dv">0</span>))</span>
<span id="cb302-13"><a href="interpolation-in-r.html#cb302-13"></a></span>
<span id="cb302-14"><a href="interpolation-in-r.html#cb302-14"></a><span class="co"># The following plot allows us to assess the fit</span></span>
<span id="cb302-15"><a href="interpolation-in-r.html#cb302-15"></a><span class="kw">plot</span>(var.smpl, dat.fit, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1000000</span>))</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="generate-kriged-surface" class="section level3 unnumbered">
<h3>Generate Kriged surface</h3>
<p>Next, use the variogram model <code>dat.fit</code> to generate a kriged interpolated surface. The <code>krige</code> function allows us to include the trend model thus saving us from having to de-trend the data, krige the residuals, then combine the two rasters. Instead, all we need to do is pass <code>krige</code> the trend formula <code>f.1</code>.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="interpolation-in-r.html#cb303-1"></a><span class="co"># Define the trend model</span></span>
<span id="cb303-2"><a href="interpolation-in-r.html#cb303-2"></a>f<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">as.formula</span>(Precip_in <span class="op">~</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span>Y) </span>
<span id="cb303-3"><a href="interpolation-in-r.html#cb303-3"></a></span>
<span id="cb303-4"><a href="interpolation-in-r.html#cb303-4"></a><span class="co"># Perform the krige interpolation (note the use of the variogram model</span></span>
<span id="cb303-5"><a href="interpolation-in-r.html#cb303-5"></a><span class="co"># created in the earlier step)</span></span>
<span id="cb303-6"><a href="interpolation-in-r.html#cb303-6"></a>dat.krg &lt;-<span class="st"> </span><span class="kw">krige</span>( f<span class="fl">.1</span>, P, grd, dat.fit)</span>
<span id="cb303-7"><a href="interpolation-in-r.html#cb303-7"></a></span>
<span id="cb303-8"><a href="interpolation-in-r.html#cb303-8"></a><span class="co"># Convert kriged surface to a raster object for clipping</span></span>
<span id="cb303-9"><a href="interpolation-in-r.html#cb303-9"></a>r &lt;-<span class="st"> </span><span class="kw">raster</span>(dat.krg)</span>
<span id="cb303-10"><a href="interpolation-in-r.html#cb303-10"></a>r.m &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb303-11"><a href="interpolation-in-r.html#cb303-11"></a></span>
<span id="cb303-12"><a href="interpolation-in-r.html#cb303-12"></a><span class="co"># Plot the map</span></span>
<span id="cb303-13"><a href="interpolation-in-r.html#cb303-13"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span></span>
<span id="cb303-14"><a href="interpolation-in-r.html#cb303-14"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">palette=</span><span class="st">&quot;RdBu&quot;</span>, <span class="dt">auto.palette.mapping=</span><span class="ot">FALSE</span>, </span>
<span id="cb303-15"><a href="interpolation-in-r.html#cb303-15"></a>            <span class="dt">title=</span><span class="st">&quot;Predicted precipitation </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span></span>
<span id="cb303-16"><a href="interpolation-in-r.html#cb303-16"></a><span class="st">  </span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb303-17"><a href="interpolation-in-r.html#cb303-17"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="generate-the-variance-and-confidence-interval-maps" class="section level3 unnumbered">
<h3>Generate the variance and confidence interval maps</h3>
<p>The <code>dat.krg</code> object stores not just the interpolated values, but the variance values as well. These can be passed to the raster object for mapping as follows:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="interpolation-in-r.html#cb304-1"></a>r   &lt;-<span class="st"> </span><span class="kw">raster</span>(dat.krg, <span class="dt">layer=</span><span class="st">&quot;var1.var&quot;</span>)</span>
<span id="cb304-2"><a href="interpolation-in-r.html#cb304-2"></a>r.m &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb304-3"><a href="interpolation-in-r.html#cb304-3"></a></span>
<span id="cb304-4"><a href="interpolation-in-r.html#cb304-4"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span></span>
<span id="cb304-5"><a href="interpolation-in-r.html#cb304-5"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">7</span>, <span class="dt">palette =</span><span class="st">&quot;Reds&quot;</span>,</span>
<span id="cb304-6"><a href="interpolation-in-r.html#cb304-6"></a>            <span class="dt">title=</span><span class="st">&quot;Variance map </span><span class="ch">\n</span><span class="st">(in squared inches)&quot;</span>) <span class="op">+</span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb304-7"><a href="interpolation-in-r.html#cb304-7"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Are more readily interpretable map is the 95% confidence interval map which can be generated from the variance object as follows (the map values should be interpreted as the number of inches above and below the estimated rainfall amount).</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="interpolation-in-r.html#cb305-1"></a>r   &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">raster</span>(dat.krg, <span class="dt">layer=</span><span class="st">&quot;var1.var&quot;</span>)) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span></span>
<span id="cb305-2"><a href="interpolation-in-r.html#cb305-2"></a>r.m &lt;-<span class="st"> </span><span class="kw">mask</span>(r, W)</span>
<span id="cb305-3"><a href="interpolation-in-r.html#cb305-3"></a></span>
<span id="cb305-4"><a href="interpolation-in-r.html#cb305-4"></a><span class="kw">tm_shape</span>(r.m) <span class="op">+</span><span class="st"> </span></span>
<span id="cb305-5"><a href="interpolation-in-r.html#cb305-5"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="dt">n=</span><span class="dv">7</span>, <span class="dt">palette =</span><span class="st">&quot;Reds&quot;</span>,</span>
<span id="cb305-6"><a href="interpolation-in-r.html#cb305-6"></a>            <span class="dt">title=</span><span class="st">&quot;95% CI map </span><span class="ch">\n</span><span class="st">(in inches)&quot;</span>) <span class="op">+</span><span class="kw">tm_shape</span>(P) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb305-7"><a href="interpolation-in-r.html#cb305-7"></a><span class="st">  </span><span class="kw">tm_legend</span>(<span class="dt">legend.outside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="A09-Interpolation_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-autocorrelation-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
